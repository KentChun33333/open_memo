import{d as nt,aN as An,aO as _n,aP as Ln,aQ as Zs,aR as gt,aS as ht,aT as Ks,aU as Us,aV as qs,r as P,j as S}from"./index-B2GV5NfK.js";function re(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=re(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const le={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Te=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Hn=["Enter"," ","Escape"],Dn={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Me;(function(e){e.Strict="strict",e.Loose="loose"})(Me||(Me={}));var we;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(we||(we={}));var ze;(function(e){e.Partial="partial",e.Full="full"})(ze||(ze={}));const Tn={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var pe;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(pe||(pe={}));var qe;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(qe||(qe={}));var F;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(F||(F={}));const Wt={[F.Left]:F.Right,[F.Right]:F.Left,[F.Top]:F.Bottom,[F.Bottom]:F.Top};function zn(e){return e===null?null:e?"valid":"invalid"}const jn=e=>"id"in e&&"source"in e&&"target"in e,Qs=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Mt=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Re=(e,t=[0,0])=>{const{width:n,height:o}=de(e),s=e.origin??t,r=n*s[0],i=o*s[1];return{x:e.position.x-r,y:e.position.y-i}},Js=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const r=typeof s=="string";let i=!t.nodeLookup&&!r?s:void 0;t.nodeLookup&&(i=r?t.nodeLookup.get(s):Mt(s)?s:t.nodeLookup.get(s.id));const c=i?Qe(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return ot(o,c)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return st(n)},Fe=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return e.forEach(s=>{(t.filter===void 0||t.filter(s))&&(n=ot(n,Qe(s)),o=!0)}),o?st(n):{x:0,y:0,width:0,height:0}},It=(e,t,[n,o,s]=[0,0,1],r=!1,i=!1)=>{const c={...Ye(t,[n,o,s]),width:t.width/s,height:t.height/s},l=[];for(const f of e.values()){const{measured:h,selectable:a=!0,hidden:u=!1}=f;if(i&&!a||u)continue;const p=h.width??f.width??f.initialWidth??null,g=h.height??f.height??f.initialHeight??null,x=je(c,Pe(f)),m=(p??0)*(g??0),y=r&&x>0;(!f.internals.handleBounds||y||x>=m||f.dragging)&&l.push(f)}return l},er=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function tr(e,t){const n=new Map,o=t!=null&&t.nodes?new Set(t.nodes.map(s=>s.id)):null;return e.forEach(s=>{s.measured.width&&s.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!s.hidden)&&(!o||o.has(s.id))&&n.set(s.id,s)}),n}async function nr({nodes:e,width:t,height:n,panZoom:o,minZoom:s,maxZoom:r},i){if(e.size===0)return Promise.resolve(!0);const c=tr(e,i),l=Fe(c),f=Pt(l,t,n,(i==null?void 0:i.minZoom)??s,(i==null?void 0:i.maxZoom)??r,(i==null?void 0:i.padding)??.1);return await o.setViewport(f,{duration:i==null?void 0:i.duration,ease:i==null?void 0:i.ease,interpolate:i==null?void 0:i.interpolate}),Promise.resolve(!0)}function Bn({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:s,onError:r}){const i=n.get(e),c=i.parentId?n.get(i.parentId):void 0,{x:l,y:f}=c?c.internals.positionAbsolute:{x:0,y:0},h=i.origin??o;let a=i.extent||s;if(i.extent==="parent"&&!i.expandParent)if(!c)r==null||r("005",le.error005());else{const p=c.measured.width,g=c.measured.height;p&&g&&(a=[[l,f],[l+p,f+g]])}else c&&ke(i.extent)&&(a=[[i.extent[0][0]+l,i.extent[0][1]+f],[i.extent[1][0]+l,i.extent[1][1]+f]]);const u=ke(a)?be(t,a,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&(r==null||r("015",le.error015())),{position:{x:u.x-l+(i.measured.width??0)*h[0],y:u.y-f+(i.measured.height??0)*h[1]},positionAbsolute:u}}async function or({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:s}){const r=new Set(e.map(u=>u.id)),i=[];for(const u of n){if(u.deletable===!1)continue;const p=r.has(u.id),g=!p&&u.parentId&&i.find(x=>x.id===u.parentId);(p||g)&&i.push(u)}const c=new Set(t.map(u=>u.id)),l=o.filter(u=>u.deletable!==!1),h=er(i,l);for(const u of l)c.has(u.id)&&!h.find(g=>g.id===u.id)&&h.push(u);if(!s)return{edges:h,nodes:i};const a=await s({nodes:i,edges:h});return typeof a=="boolean"?a?{edges:h,nodes:i}:{edges:[],nodes:[]}:a}const Ie=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),be=(e={x:0,y:0},t,n)=>({x:Ie(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:Ie(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function Vn(e,t,n){const{width:o,height:s}=de(n),{x:r,y:i}=n.internals.positionAbsolute;return be(e,[[r,i],[r+o,i+s]],t)}const Xt=(e,t,n)=>e<t?Ie(Math.abs(e-t),1,t)/t:e>n?-Ie(Math.abs(e-n),1,t)/t:0,Rn=(e,t,n=15,o=40)=>{const s=Xt(e.x,o,t.width-o)*n,r=Xt(e.y,o,t.height-o)*n;return[s,r]},ot=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),bt=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),st=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Pe=(e,t=[0,0])=>{var s,r;const{x:n,y:o}=Mt(e)?e.internals.positionAbsolute:Re(e,t);return{x:n,y:o,width:((s=e.measured)==null?void 0:s.width)??e.width??e.initialWidth??0,height:((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight??0}},Qe=(e,t=[0,0])=>{var s,r;const{x:n,y:o}=Mt(e)?e.internals.positionAbsolute:Re(e,t);return{x:n,y:o,x2:n+(((s=e.measured)==null?void 0:s.width)??e.width??e.initialWidth??0),y2:o+(((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight??0)}},Fn=(e,t)=>st(ot(bt(e),bt(t))),je=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Gt=e=>ce(e.width)&&ce(e.height)&&ce(e.x)&&ce(e.y),ce=e=>!isNaN(e)&&isFinite(e),sr=(e,t)=>{},Oe=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Ye=({x:e,y:t},[n,o,s],r=!1,i=[1,1])=>{const c={x:(e-n)/s,y:(t-o)/s};return r?Oe(c,i):c},Je=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o});function Se(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function rr(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=Se(e,n),s=Se(e,t);return{top:o,right:s,bottom:o,left:s,x:s*2,y:o*2}}if(typeof e=="object"){const o=Se(e.top??e.y??0,n),s=Se(e.bottom??e.y??0,n),r=Se(e.left??e.x??0,t),i=Se(e.right??e.x??0,t);return{top:o,right:i,bottom:s,left:r,x:r+i,y:o+s}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function ir(e,t,n,o,s,r){const{x:i,y:c}=Je(e,[t,n,o]),{x:l,y:f}=Je({x:e.x+e.width,y:e.y+e.height},[t,n,o]),h=s-l,a=r-f;return{left:Math.floor(i),top:Math.floor(c),right:Math.floor(h),bottom:Math.floor(a)}}const Pt=(e,t,n,o,s,r)=>{const i=rr(r,t,n),c=(t-i.x)/e.width,l=(n-i.y)/e.height,f=Math.min(c,l),h=Ie(f,o,s),a=e.x+e.width/2,u=e.y+e.height/2,p=t/2-a*h,g=n/2-u*h,x=ir(e,p,g,h,t,n),m={left:Math.min(x.left-i.left,0),top:Math.min(x.top-i.top,0),right:Math.min(x.right-i.right,0),bottom:Math.min(x.bottom-i.bottom,0)};return{x:p-m.left+m.right,y:g-m.top+m.bottom,zoom:h}},Be=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function ke(e){return e!=null&&e!=="parent"}function de(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function On(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function Yn(e,t={width:0,height:0},n,o,s){const r={...e},i=o.get(n);if(i){const c=i.origin||s;r.x+=i.internals.positionAbsolute.x-(t.width??0)*c[0],r.y+=i.internals.positionAbsolute.y-(t.height??0)*c[1]}return r}function Zt(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function cr(){let e,t;return{promise:new Promise((o,s)=>{e=o,t=s}),resolve:e,reject:t}}function ar(e){return{...Dn,...e||{}}}function De(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:s}){const{x:r,y:i}=ae(e),c=Ye({x:r-((s==null?void 0:s.left)??0),y:i-((s==null?void 0:s.top)??0)},o),{x:l,y:f}=n?Oe(c,t):c;return{xSnapped:l,ySnapped:f,...c}}const kt=e=>({width:e.offsetWidth,height:e.offsetHeight}),Wn=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},lr=["INPUT","SELECT","TEXTAREA"];function Xn(e){var o,s;const t=((s=(o=e.composedPath)==null?void 0:o.call(e))==null?void 0:s[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:lr.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const Gn=e=>"clientX"in e,ae=(e,t)=>{var r,i;const n=Gn(e),o=n?e.clientX:(r=e.touches)==null?void 0:r[0].clientX,s=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},Kt=(e,t,n,o,s)=>{const r=t.querySelectorAll(`.${e}`);return!r||!r.length?null:Array.from(r).map(i=>{const c=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:s,position:i.getAttribute("data-handlepos"),x:(c.left-n.left)/o,y:(c.top-n.top)/o,...kt(i)}})};function Zn({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:r,targetControlX:i,targetControlY:c}){const l=e*.125+s*.375+i*.375+n*.125,f=t*.125+r*.375+c*.375+o*.125,h=Math.abs(l-e),a=Math.abs(f-t);return[l,f,h,a]}function Ge(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Ut({pos:e,x1:t,y1:n,x2:o,y2:s,c:r}){switch(e){case F.Left:return[t-Ge(t-o,r),n];case F.Right:return[t+Ge(o-t,r),n];case F.Top:return[t,n-Ge(n-s,r)];case F.Bottom:return[t,n+Ge(s-n,r)]}}function Kn({sourceX:e,sourceY:t,sourcePosition:n=F.Bottom,targetX:o,targetY:s,targetPosition:r=F.Top,curvature:i=.25}){const[c,l]=Ut({pos:n,x1:e,y1:t,x2:o,y2:s,c:i}),[f,h]=Ut({pos:r,x1:o,y1:s,x2:e,y2:t,c:i}),[a,u,p,g]=Zn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:c,sourceControlY:l,targetControlX:f,targetControlY:h});return[`M${e},${t} C${c},${l} ${f},${h} ${o},${s}`,a,u,p,g]}function Un({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,r=n<e?n+s:n-s,i=Math.abs(o-t)/2,c=o<t?o+i:o-i;return[r,c,s,i]}function ur({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:s=!1,zIndexMode:r="basic"}){if(r==="manual")return o;const i=s&&n?o+1e3:o,c=Math.max(e.parentId||s&&e.selected?e.internals.z:0,t.parentId||s&&t.selected?t.internals.z:0);return i+c}function dr({sourceNode:e,targetNode:t,width:n,height:o,transform:s}){const r=ot(Qe(e),Qe(t));r.x===r.x2&&(r.x2+=1),r.y===r.y2&&(r.y2+=1);const i={x:-s[0]/s[2],y:-s[1]/s[2],width:n/s[2],height:o/s[2]};return je(i,st(r))>0}const fr=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,gr=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),hr=(e,t,n={})=>{if(!e.source||!e.target)return t;const o=n.getEdgeId||fr;let s;return jn(e)?s={...e}:s={...e,id:o(e)},gr(s,t)?t:(s.sourceHandle===null&&delete s.sourceHandle,s.targetHandle===null&&delete s.targetHandle,t.concat(s))};function qn({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,r,i,c]=Un({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,r,i,c]}const qt={[F.Left]:{x:-1,y:0},[F.Right]:{x:1,y:0},[F.Top]:{x:0,y:-1},[F.Bottom]:{x:0,y:1}},pr=({source:e,sourcePosition:t=F.Bottom,target:n})=>t===F.Left||t===F.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Qt=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function mr({source:e,sourcePosition:t=F.Bottom,target:n,targetPosition:o=F.Top,center:s,offset:r,stepPosition:i}){const c=qt[t],l=qt[o],f={x:e.x+c.x*r,y:e.y+c.y*r},h={x:n.x+l.x*r,y:n.y+l.y*r},a=pr({source:f,sourcePosition:t,target:h}),u=a.x!==0?"x":"y",p=a[u];let g=[],x,m;const y={x:0,y:0},w={x:0,y:0},[,,d,b]=Un({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(c[u]*l[u]===-1){u==="x"?(x=s.x??f.x+(h.x-f.x)*i,m=s.y??(f.y+h.y)/2):(x=s.x??(f.x+h.x)/2,m=s.y??f.y+(h.y-f.y)*i);const E=[{x,y:f.y},{x,y:h.y}],C=[{x:f.x,y:m},{x:h.x,y:m}];c[u]===p?g=u==="x"?E:C:g=u==="x"?C:E}else{const E=[{x:f.x,y:h.y}],C=[{x:h.x,y:f.y}];if(u==="x"?g=c.x===p?C:E:g=c.y===p?E:C,t===o){const N=Math.abs(e[u]-n[u]);if(N<=r){const _=Math.min(r-1,r-N);c[u]===p?y[u]=(f[u]>e[u]?-1:1)*_:w[u]=(h[u]>n[u]?-1:1)*_}}if(t!==o){const N=u==="x"?"y":"x",_=c[u]===l[N],T=f[N]>h[N],H=f[N]<h[N];(c[u]===1&&(!_&&T||_&&H)||c[u]!==1&&(!_&&H||_&&T))&&(g=u==="x"?E:C)}const $={x:f.x+y.x,y:f.y+y.y},k={x:h.x+w.x,y:h.y+w.y},j=Math.max(Math.abs($.x-g[0].x),Math.abs(k.x-g[0].x)),v=Math.max(Math.abs($.y-g[0].y),Math.abs(k.y-g[0].y));j>=v?(x=($.x+k.x)/2,m=g[0].y):(x=g[0].x,m=($.y+k.y)/2)}return[[e,{x:f.x+y.x,y:f.y+y.y},...g,{x:h.x+w.x,y:h.y+w.y},n],x,m,d,b]}function yr(e,t,n,o){const s=Math.min(Qt(e,t)/2,Qt(t,n)/2,o),{x:r,y:i}=t;if(e.x===r&&r===n.x||e.y===i&&i===n.y)return`L${r} ${i}`;if(e.y===i){const f=e.x<n.x?-1:1,h=e.y<n.y?1:-1;return`L ${r+s*f},${i}Q ${r},${i} ${r},${i+s*h}`}const c=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${r},${i+s*l}Q ${r},${i} ${r+s*c},${i}`}function Et({sourceX:e,sourceY:t,sourcePosition:n=F.Bottom,targetX:o,targetY:s,targetPosition:r=F.Top,borderRadius:i=5,centerX:c,centerY:l,offset:f=20,stepPosition:h=.5}){const[a,u,p,g,x]=mr({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:r,center:{x:c,y:l},offset:f,stepPosition:h});return[a.reduce((y,w,d)=>{let b="";return d>0&&d<a.length-1?b=yr(a[d-1],w,a[d+1],i):b=`${d===0?"M":"L"}${w.x} ${w.y}`,y+=b,y},""),u,p,g,x]}function Jt(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function xr(e){var a;const{sourceNode:t,targetNode:n}=e;if(!Jt(t)||!Jt(n))return null;const o=t.internals.handleBounds||en(t.handles),s=n.internals.handleBounds||en(n.handles),r=tn((o==null?void 0:o.source)??[],e.sourceHandle),i=tn(e.connectionMode===Me.Strict?(s==null?void 0:s.target)??[]:((s==null?void 0:s.target)??[]).concat((s==null?void 0:s.source)??[]),e.targetHandle);if(!r||!i)return(a=e.onError)==null||a.call(e,"008",le.error008(r?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const c=(r==null?void 0:r.position)||F.Bottom,l=(i==null?void 0:i.position)||F.Top,f=Ee(t,r,c),h=Ee(n,i,l);return{sourceX:f.x,sourceY:f.y,targetX:h.x,targetY:h.y,sourcePosition:c,targetPosition:l}}function en(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function Ee(e,t,n=F.Left,o=!1){const s=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,r=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:c}=t??de(e);if(o)return{x:s+i/2,y:r+c/2};switch((t==null?void 0:t.position)??n){case F.Top:return{x:s+i/2,y:r};case F.Right:return{x:s+i,y:r+c/2};case F.Bottom:return{x:s+i/2,y:r+c};case F.Left:return{x:s,y:r+c/2}}}function tn(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function vt(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function wr(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:s}){const r=new Set;return e.reduce((i,c)=>([c.markerStart||o,c.markerEnd||s].forEach(l=>{if(l&&typeof l=="object"){const f=vt(l,t);r.has(f)||(i.push({id:f,color:l.color||n,...l}),r.add(f))}}),i),[]).sort((i,c)=>i.id.localeCompare(c.id))}const Qn=1e3,br=10,$t={nodeOrigin:[0,0],nodeExtent:Te,elevateNodesOnSelect:!0,zIndexMode:"basic",defaults:{}},Er={...$t,checkEquality:!0};function At(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function vr(e,t,n){const o=At($t,n);for(const s of e.values())if(s.parentId)Lt(s,e,t,o);else{const r=Re(s,o.nodeOrigin),i=ke(s.extent)?s.extent:o.nodeExtent,c=be(r,i,de(s));s.internals.positionAbsolute=c}}function Sr(e,t){if(!e.handles)return e.measured?t==null?void 0:t.internals.handleBounds:void 0;const n=[],o=[];for(const s of e.handles){const r={id:s.id,width:s.width??1,height:s.height??1,nodeId:e.id,x:s.x,y:s.y,position:s.position,type:s.type};s.type==="source"?n.push(r):s.type==="target"&&o.push(r)}return{source:n,target:o}}function _t(e){return e==="manual"}function St(e,t,n,o={}){var f,h;const s=At(Er,o),r={i:0},i=new Map(t),c=s!=null&&s.elevateNodesOnSelect&&!_t(s.zIndexMode)?Qn:0;let l=e.length>0;t.clear(),n.clear();for(const a of e){let u=i.get(a.id);if(s.checkEquality&&a===(u==null?void 0:u.internals.userNode))t.set(a.id,u);else{const p=Re(a,s.nodeOrigin),g=ke(a.extent)?a.extent:s.nodeExtent,x=be(p,g,de(a));u={...s.defaults,...a,measured:{width:(f=a.measured)==null?void 0:f.width,height:(h=a.measured)==null?void 0:h.height},internals:{positionAbsolute:x,handleBounds:Sr(a,u),z:Jn(a,c,s.zIndexMode),userNode:a}},t.set(a.id,u)}(u.measured===void 0||u.measured.width===void 0||u.measured.height===void 0)&&!u.hidden&&(l=!1),a.parentId&&Lt(u,t,n,o,r)}return l}function Nr(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Lt(e,t,n,o,s){const{elevateNodesOnSelect:r,nodeOrigin:i,nodeExtent:c,zIndexMode:l}=At($t,o),f=e.parentId,h=t.get(f);if(!h){console.warn(`Parent node ${f} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Nr(e,n),s&&!h.parentId&&h.internals.rootParentIndex===void 0&&l==="auto"&&(h.internals.rootParentIndex=++s.i,h.internals.z=h.internals.z+s.i*br),s&&h.internals.rootParentIndex!==void 0&&(s.i=h.internals.rootParentIndex);const a=r&&!_t(l)?Qn:0,{x:u,y:p,z:g}=Cr(e,h,i,c,a,l),{positionAbsolute:x}=e.internals,m=u!==x.x||p!==x.y;(m||g!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:m?{x:u,y:p}:x,z:g}})}function Jn(e,t,n){const o=ce(e.zIndex)?e.zIndex:0;return _t(n)?o:o+(e.selected?t:0)}function Cr(e,t,n,o,s,r){const{x:i,y:c}=t.internals.positionAbsolute,l=de(e),f=Re(e,n),h=ke(e.extent)?be(f,e.extent,l):f;let a=be({x:i+h.x,y:c+h.y},o,l);e.extent==="parent"&&(a=Vn(a,l,t));const u=Jn(e,s,r),p=t.internals.z??0;return{x:a.x,y:a.y,z:p>=u?p+1:u}}function Ht(e,t,n,o=[0,0]){var i;const s=[],r=new Map;for(const c of e){const l=t.get(c.parentId);if(!l)continue;const f=((i=r.get(c.parentId))==null?void 0:i.expandedRect)??Pe(l),h=Fn(f,c.rect);r.set(c.parentId,{expandedRect:h,parent:l})}return r.size>0&&r.forEach(({expandedRect:c,parent:l},f)=>{var d;const h=l.internals.positionAbsolute,a=de(l),u=l.origin??o,p=c.x<h.x?Math.round(Math.abs(h.x-c.x)):0,g=c.y<h.y?Math.round(Math.abs(h.y-c.y)):0,x=Math.max(a.width,Math.round(c.width)),m=Math.max(a.height,Math.round(c.height)),y=(x-a.width)*u[0],w=(m-a.height)*u[1];(p>0||g>0||y||w)&&(s.push({id:f,type:"position",position:{x:l.position.x-p+y,y:l.position.y-g+w}}),(d=n.get(f))==null||d.forEach(b=>{e.some(M=>M.id===b.id)||s.push({id:b.id,type:"position",position:{x:b.position.x+p,y:b.position.y+g}})})),(a.width<c.width||a.height<c.height||p||g)&&s.push({id:f,type:"dimensions",setAttributes:!0,dimensions:{width:x+(p?u[0]*p-y:0),height:m+(g?u[1]*g-w:0)}})}),s}function Mr(e,t,n,o,s,r,i){const c=o==null?void 0:o.querySelector(".xyflow__viewport");let l=!1;if(!c)return{changes:[],updatedInternals:l};const f=[],h=window.getComputedStyle(c),{m22:a}=new window.DOMMatrixReadOnly(h.transform),u=[];for(const p of e.values()){const g=t.get(p.id);if(!g)continue;if(g.hidden){t.set(g.id,{...g,internals:{...g.internals,handleBounds:void 0}}),l=!0;continue}const x=kt(p.nodeElement),m=g.measured.width!==x.width||g.measured.height!==x.height;if(!!(x.width&&x.height&&(m||!g.internals.handleBounds||p.force))){const w=p.nodeElement.getBoundingClientRect(),d=ke(g.extent)?g.extent:r;let{positionAbsolute:b}=g.internals;g.parentId&&g.extent==="parent"?b=Vn(b,x,t.get(g.parentId)):d&&(b=be(b,d,x));const M={...g,measured:x,internals:{...g.internals,positionAbsolute:b,handleBounds:{source:Kt("source",p.nodeElement,w,a,g.id),target:Kt("target",p.nodeElement,w,a,g.id)}}};t.set(g.id,M),g.parentId&&Lt(M,t,n,{nodeOrigin:s,zIndexMode:i}),l=!0,m&&(f.push({id:g.id,type:"dimensions",dimensions:x}),g.expandParent&&g.parentId&&u.push({id:g.id,parentId:g.parentId,rect:Pe(M,s)}))}}if(u.length>0){const p=Ht(u,t,n,s);f.push(...p)}return{changes:f,updatedInternals:l}}async function Ir({delta:e,panZoom:t,transform:n,translateExtent:o,width:s,height:r}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[s,r]],o),c=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(c)}function nn(e,t,n,o,s,r){let i=s;const c=o.get(i)||new Map;o.set(i,c.set(n,t)),i=`${s}-${e}`;const l=o.get(i)||new Map;if(o.set(i,l.set(n,t)),r){i=`${s}-${e}-${r}`;const f=o.get(i)||new Map;o.set(i,f.set(n,t))}}function eo(e,t,n){e.clear(),t.clear();for(const o of n){const{source:s,target:r,sourceHandle:i=null,targetHandle:c=null}=o,l={edgeId:o.id,source:s,target:r,sourceHandle:i,targetHandle:c},f=`${s}-${i}--${r}-${c}`,h=`${r}-${c}--${s}-${i}`;nn("source",l,h,e,s,i),nn("target",l,f,e,r,c),t.set(o.id,o)}}function to(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:to(n,t):!1}function on(e,t,n){var s;let o=e;do{if((s=o==null?void 0:o.matches)!=null&&s.call(o,t))return!0;if(o===n)return!1;o=o==null?void 0:o.parentElement}while(o);return!1}function Pr(e,t,n,o){const s=new Map;for(const[r,i]of e)if((i.selected||i.id===o)&&(!i.parentId||!to(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const c=e.get(r);c&&s.set(r,{id:r,position:c.position||{x:0,y:0},distance:{x:n.x-c.internals.positionAbsolute.x,y:n.y-c.internals.positionAbsolute.y},extent:c.extent,parentId:c.parentId,origin:c.origin,expandParent:c.expandParent,internals:{positionAbsolute:c.internals.positionAbsolute||{x:0,y:0}},measured:{width:c.measured.width??0,height:c.measured.height??0}})}return s}function pt({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){var i,c,l;const s=[];for(const[f,h]of t){const a=(i=n.get(f))==null?void 0:i.internals.userNode;a&&s.push({...a,position:h.position,dragging:o})}if(!e)return[s[0],s];const r=(c=n.get(e))==null?void 0:c.internals.userNode;return[r?{...r,position:((l=t.get(e))==null?void 0:l.position)||r.position,dragging:o}:s[0],s]}function kr({dragItems:e,snapGrid:t,x:n,y:o}){const s=e.values().next().value;if(!s)return null;const r={x:n-s.distance.x,y:o-s.distance.y},i=Oe(r,t);return{x:i.x-r.x,y:i.y-r.y}}function $r({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:s}){let r={x:null,y:null},i=0,c=new Map,l=!1,f={x:0,y:0},h=null,a=!1,u=null,p=!1,g=!1,x=null;function m({noDragClassName:w,handleSelector:d,domNode:b,isSelectable:M,nodeId:E,nodeClickDistance:C=0}){u=nt(b);function $({x:N,y:_}){const{nodeLookup:T,nodeExtent:H,snapGrid:B,snapToGrid:D,nodeOrigin:A,onNodeDrag:I,onSelectionDrag:V,onError:z,updateNodePositions:L}=t();r={x:N,y:_};let O=!1;const G=c.size>1,K=G&&H?bt(Fe(c)):null,U=G&&D?kr({dragItems:c,snapGrid:B,x:N,y:_}):null;for(const[q,R]of c){if(!T.has(q))continue;let X={x:N-R.distance.x,y:_-R.distance.y};D&&(X=U?{x:Math.round(X.x+U.x),y:Math.round(X.y+U.y)}:Oe(X,B));let Q=null;if(G&&H&&!R.extent&&K){const{positionAbsolute:Y}=R.internals,te=Y.x-K.x+H[0][0],ne=Y.x+R.measured.width-K.x2+H[1][0],ee=Y.y-K.y+H[0][1],ie=Y.y+R.measured.height-K.y2+H[1][1];Q=[[te,ee],[ne,ie]]}const{position:Z,positionAbsolute:W}=Bn({nodeId:q,nextPosition:X,nodeLookup:T,nodeExtent:Q||H,nodeOrigin:A,onError:z});O=O||R.position.x!==Z.x||R.position.y!==Z.y,R.position=Z,R.internals.positionAbsolute=W}if(g=g||O,!!O&&(L(c,!0),x&&(o||I||!E&&V))){const[q,R]=pt({nodeId:E,dragItems:c,nodeLookup:T});o==null||o(x,c,q,R),I==null||I(x,q,R),E||V==null||V(x,R)}}async function k(){if(!h)return;const{transform:N,panBy:_,autoPanSpeed:T,autoPanOnNodeDrag:H}=t();if(!H){l=!1,cancelAnimationFrame(i);return}const[B,D]=Rn(f,h,T);(B!==0||D!==0)&&(r.x=(r.x??0)-B/N[2],r.y=(r.y??0)-D/N[2],await _({x:B,y:D})&&$(r)),i=requestAnimationFrame(k)}function j(N){var G;const{nodeLookup:_,multiSelectionActive:T,nodesDraggable:H,transform:B,snapGrid:D,snapToGrid:A,selectNodesOnDrag:I,onNodeDragStart:V,onSelectionDragStart:z,unselectNodesAndEdges:L}=t();a=!0,(!I||!M)&&!T&&E&&((G=_.get(E))!=null&&G.selected||L()),M&&I&&E&&(e==null||e(E));const O=De(N.sourceEvent,{transform:B,snapGrid:D,snapToGrid:A,containerBounds:h});if(r=O,c=Pr(_,H,O,E),c.size>0&&(n||V||!E&&z)){const[K,U]=pt({nodeId:E,dragItems:c,nodeLookup:_});n==null||n(N.sourceEvent,c,K,U),V==null||V(N.sourceEvent,K,U),E||z==null||z(N.sourceEvent,U)}}const v=Ln().clickDistance(C).on("start",N=>{const{domNode:_,nodeDragThreshold:T,transform:H,snapGrid:B,snapToGrid:D}=t();h=(_==null?void 0:_.getBoundingClientRect())||null,p=!1,g=!1,x=N.sourceEvent,T===0&&j(N),r=De(N.sourceEvent,{transform:H,snapGrid:B,snapToGrid:D,containerBounds:h}),f=ae(N.sourceEvent,h)}).on("drag",N=>{const{autoPanOnNodeDrag:_,transform:T,snapGrid:H,snapToGrid:B,nodeDragThreshold:D,nodeLookup:A}=t(),I=De(N.sourceEvent,{transform:T,snapGrid:H,snapToGrid:B,containerBounds:h});if(x=N.sourceEvent,(N.sourceEvent.type==="touchmove"&&N.sourceEvent.touches.length>1||E&&!A.has(E))&&(p=!0),!p){if(!l&&_&&a&&(l=!0,k()),!a){const V=ae(N.sourceEvent,h),z=V.x-f.x,L=V.y-f.y;Math.sqrt(z*z+L*L)>D&&j(N)}(r.x!==I.xSnapped||r.y!==I.ySnapped)&&c&&a&&(f=ae(N.sourceEvent,h),$(I))}}).on("end",N=>{if(!(!a||p)&&(l=!1,a=!1,cancelAnimationFrame(i),c.size>0)){const{nodeLookup:_,updateNodePositions:T,onNodeDragStop:H,onSelectionDragStop:B}=t();if(g&&(T(c,!1),g=!1),s||H||!E&&B){const[D,A]=pt({nodeId:E,dragItems:c,nodeLookup:_,dragging:!1});s==null||s(N.sourceEvent,c,D,A),H==null||H(N.sourceEvent,D,A),E||B==null||B(N.sourceEvent,A)}}}).filter(N=>{const _=N.target;return!N.button&&(!w||!on(_,`.${w}`,b))&&(!d||on(_,d,b))});u.call(v)}function y(){u==null||u.on(".drag",null)}return{update:m,destroy:y}}function Ar(e,t,n){const o=[],s={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const r of t.values())je(s,Pe(r))>0&&o.push(r);return o}const _r=250;function Lr(e,t,n,o){var c,l;let s=[],r=1/0;const i=Ar(e,n,t+_r);for(const f of i){const h=[...((c=f.internals.handleBounds)==null?void 0:c.source)??[],...((l=f.internals.handleBounds)==null?void 0:l.target)??[]];for(const a of h){if(o.nodeId===a.nodeId&&o.type===a.type&&o.id===a.id)continue;const{x:u,y:p}=Ee(f,a,a.position,!0),g=Math.sqrt(Math.pow(u-e.x,2)+Math.pow(p-e.y,2));g>t||(g<r?(s=[{...a,x:u,y:p}],r=g):g===r&&s.push({...a,x:u,y:p}))}}if(!s.length)return null;if(s.length>1){const f=o.type==="source"?"target":"source";return s.find(h=>h.type===f)??s[0]}return s[0]}function no(e,t,n,o,s,r=!1){var f,h,a;const i=o.get(e);if(!i)return null;const c=s==="strict"?(f=i.internals.handleBounds)==null?void 0:f[t]:[...((h=i.internals.handleBounds)==null?void 0:h.source)??[],...((a=i.internals.handleBounds)==null?void 0:a.target)??[]],l=(n?c==null?void 0:c.find(u=>u.id===n):c==null?void 0:c[0])??null;return l&&r?{...l,...Ee(i,l,l.position,!0)}:l}function oo(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Hr(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const so=()=>!0;function Dr(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:s,edgeUpdaterType:r,isTarget:i,domNode:c,nodeLookup:l,lib:f,autoPanOnConnect:h,flowId:a,panBy:u,cancelConnection:p,onConnectStart:g,onConnect:x,onConnectEnd:m,isValidConnection:y=so,onReconnectEnd:w,updateConnection:d,getTransform:b,getFromHandle:M,autoPanSpeed:E,dragThreshold:C=1,handleDomNode:$}){const k=Wn(e.target);let j=0,v;const{x:N,y:_}=ae(e),T=oo(r,$),H=c==null?void 0:c.getBoundingClientRect();let B=!1;if(!H||!T)return;const D=no(s,T,o,l,t);if(!D)return;let A=ae(e,H),I=!1,V=null,z=!1,L=null;function O(){if(!h||!H)return;const[Z,W]=Rn(A,H,E);u({x:Z,y:W}),j=requestAnimationFrame(O)}const G={...D,nodeId:s,type:T,position:D.position},K=l.get(s);let q={inProgress:!0,isValid:null,from:Ee(K,G,F.Left,!0),fromHandle:G,fromPosition:G.position,fromNode:K,to:A,toHandle:null,toPosition:Wt[G.position],toNode:null,pointer:A};function R(){B=!0,d(q),g==null||g(e,{nodeId:s,handleId:o,handleType:T})}C===0&&R();function X(Z){if(!B){const{x:ie,y:fe}=ae(Z),ue=ie-N,ye=fe-_;if(!(ue*ue+ye*ye>C*C))return;R()}if(!M()||!G){Q(Z);return}const W=b();A=ae(Z,H),v=Lr(Ye(A,W,!1,[1,1]),n,l,G),I||(O(),I=!0);const Y=ro(Z,{handle:v,connectionMode:t,fromNodeId:s,fromHandleId:o,fromType:i?"target":"source",isValidConnection:y,doc:k,lib:f,flowId:a,nodeLookup:l});L=Y.handleDomNode,V=Y.connection,z=Hr(!!v,Y.isValid);const te=l.get(s),ne=te?Ee(te,G,F.Left,!0):q.from,ee={...q,from:ne,isValid:z,to:Y.toHandle&&z?Je({x:Y.toHandle.x,y:Y.toHandle.y},W):A,toHandle:Y.toHandle,toPosition:z&&Y.toHandle?Y.toHandle.position:Wt[G.position],toNode:Y.toHandle?l.get(Y.toHandle.nodeId):null,pointer:A};d(ee),q=ee}function Q(Z){if(!("touches"in Z&&Z.touches.length>0)){if(B){(v||L)&&V&&z&&(x==null||x(V));const{inProgress:W,...Y}=q,te={...Y,toPosition:q.toHandle?q.toPosition:null};m==null||m(Z,te),r&&(w==null||w(Z,te))}p(),cancelAnimationFrame(j),I=!1,z=!1,V=null,L=null,k.removeEventListener("mousemove",X),k.removeEventListener("mouseup",Q),k.removeEventListener("touchmove",X),k.removeEventListener("touchend",Q)}}k.addEventListener("mousemove",X),k.addEventListener("mouseup",Q),k.addEventListener("touchmove",X),k.addEventListener("touchend",Q)}function ro(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:s,fromType:r,doc:i,lib:c,flowId:l,isValidConnection:f=so,nodeLookup:h}){const a=r==="target",u=t?i.querySelector(`.${c}-flow__handle[data-id="${l}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:p,y:g}=ae(e),x=i.elementFromPoint(p,g),m=x!=null&&x.classList.contains(`${c}-flow__handle`)?x:u,y={handleDomNode:m,isValid:!1,connection:null,toHandle:null};if(m){const w=oo(void 0,m),d=m.getAttribute("data-nodeid"),b=m.getAttribute("data-handleid"),M=m.classList.contains("connectable"),E=m.classList.contains("connectableend");if(!d||!w)return y;const C={source:a?d:o,sourceHandle:a?b:s,target:a?o:d,targetHandle:a?s:b};y.connection=C;const k=M&&E&&(n===Me.Strict?a&&w==="source"||!a&&w==="target":d!==o||b!==s);y.isValid=k&&f(C),y.toHandle=no(d,w,b,h,n,!0)}return y}const Nt={onPointerDown:Dr,isValid:ro};function Tr({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const s=nt(e);function r({translateExtent:c,width:l,height:f,zoomStep:h=1,pannable:a=!0,zoomable:u=!0,inversePan:p=!1}){const g=d=>{if(d.sourceEvent.type!=="wheel"||!t)return;const b=n(),M=d.sourceEvent.ctrlKey&&Be()?10:1,E=-d.sourceEvent.deltaY*(d.sourceEvent.deltaMode===1?.05:d.sourceEvent.deltaMode?1:.002)*h,C=b[2]*Math.pow(2,E*M);t.scaleTo(C)};let x=[0,0];const m=d=>{(d.sourceEvent.type==="mousedown"||d.sourceEvent.type==="touchstart")&&(x=[d.sourceEvent.clientX??d.sourceEvent.touches[0].clientX,d.sourceEvent.clientY??d.sourceEvent.touches[0].clientY])},y=d=>{const b=n();if(d.sourceEvent.type!=="mousemove"&&d.sourceEvent.type!=="touchmove"||!t)return;const M=[d.sourceEvent.clientX??d.sourceEvent.touches[0].clientX,d.sourceEvent.clientY??d.sourceEvent.touches[0].clientY],E=[M[0]-x[0],M[1]-x[1]];x=M;const C=o()*Math.max(b[2],Math.log(b[2]))*(p?-1:1),$={x:b[0]-E[0]*C,y:b[1]-E[1]*C},k=[[0,0],[l,f]];t.setViewportConstrained({x:$.x,y:$.y,zoom:b[2]},k,c)},w=_n().on("start",m).on("zoom",a?y:null).on("zoom.wheel",u?g:null);s.call(w,{})}function i(){s.on("zoom",null)}return{update:r,destroy:i,pointer:An}}const rt=e=>({x:e.x,y:e.y,zoom:e.k}),mt=({x:e,y:t,zoom:n})=>Zs.translate(e,t).scale(n),Ne=(e,t)=>e.target.closest(`.${t}`),io=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),zr=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,yt=(e,t=0,n=zr,o=()=>{})=>{const s=typeof t=="number"&&t>0;return s||o(),s?e.transition().duration(t).ease(n).on("end",o):e},co=e=>{const t=e.ctrlKey&&Be()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function jr({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:s,panOnScrollSpeed:r,zoomOnPinch:i,onPanZoomStart:c,onPanZoom:l,onPanZoomEnd:f}){return h=>{if(Ne(h,t))return h.ctrlKey&&h.preventDefault(),!1;h.preventDefault(),h.stopImmediatePropagation();const a=n.property("__zoom").k||1;if(h.ctrlKey&&i){const m=An(h),y=co(h),w=a*Math.pow(2,y);o.scaleTo(n,w,m,h);return}const u=h.deltaMode===1?20:1;let p=s===we.Vertical?0:h.deltaX*u,g=s===we.Horizontal?0:h.deltaY*u;!Be()&&h.shiftKey&&s!==we.Vertical&&(p=h.deltaY*u,g=0),o.translateBy(n,-(p/a)*r,-(g/a)*r,{internal:!0});const x=rt(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(l==null||l(h,x),e.panScrollTimeout=setTimeout(()=>{f==null||f(h,x),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,c==null||c(h,x))}}function Br({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,s){const r=o.type==="wheel",i=!t&&r&&!o.ctrlKey,c=Ne(o,e);if(o.ctrlKey&&r&&c&&o.preventDefault(),i||c)return null;o.preventDefault(),n.call(this,o,s)}}function Vr({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{var r,i,c;if((r=o.sourceEvent)!=null&&r.internal)return;const s=rt(o.transform);e.mouseButton=((i=o.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=s,((c=o.sourceEvent)==null?void 0:c.type)==="mousedown"&&t(!0),n&&(n==null||n(o.sourceEvent,s))}}function Rr({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:s}){return r=>{var i,c;e.usedRightMouseButton=!!(n&&io(t,e.mouseButton??0)),(i=r.sourceEvent)!=null&&i.sync||o([r.transform.x,r.transform.y,r.transform.k]),s&&!((c=r.sourceEvent)!=null&&c.internal)&&(s==null||s(r.sourceEvent,rt(r.transform)))}}function Fr({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:s,onPaneContextMenu:r}){return i=>{var c;if(!((c=i.sourceEvent)!=null&&c.internal)&&(e.isZoomingOrPanning=!1,r&&io(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&r(i.sourceEvent),e.usedRightMouseButton=!1,o(!1),s)){const l=rt(i.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{s==null||s(i.sourceEvent,l)},n?150:0)}}}function Or({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:s,zoomOnDoubleClick:r,userSelectionActive:i,noWheelClassName:c,noPanClassName:l,lib:f,connectionInProgress:h}){return a=>{var m;const u=e||t,p=n&&a.ctrlKey,g=a.type==="wheel";if(a.button===1&&a.type==="mousedown"&&(Ne(a,`${f}-flow__node`)||Ne(a,`${f}-flow__edge`)))return!0;if(!o&&!u&&!s&&!r&&!n||i||h&&!g||Ne(a,c)&&g||Ne(a,l)&&(!g||s&&g&&!e)||!n&&a.ctrlKey&&g)return!1;if(!n&&a.type==="touchstart"&&((m=a.touches)==null?void 0:m.length)>1)return a.preventDefault(),!1;if(!u&&!s&&!p&&g||!o&&(a.type==="mousedown"||a.type==="touchstart")||Array.isArray(o)&&!o.includes(a.button)&&a.type==="mousedown")return!1;const x=Array.isArray(o)&&o.includes(a.button)||!a.button||a.button<=1;return(!a.ctrlKey||g)&&x}}function Yr({domNode:e,minZoom:t,maxZoom:n,translateExtent:o,viewport:s,onPanZoom:r,onPanZoomStart:i,onPanZoomEnd:c,onDraggingChange:l}){const f={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},h=e.getBoundingClientRect(),a=_n().scaleExtent([t,n]).translateExtent(o),u=nt(e).call(a);w({x:s.x,y:s.y,zoom:Ie(s.zoom,t,n)},[[0,0],[h.width,h.height]],o);const p=u.on("wheel.zoom"),g=u.on("dblclick.zoom");a.wheelDelta(co);function x(v,N){return u?new Promise(_=>{a==null||a.interpolate((N==null?void 0:N.interpolate)==="linear"?ht:gt).transform(yt(u,N==null?void 0:N.duration,N==null?void 0:N.ease,()=>_(!0)),v)}):Promise.resolve(!1)}function m({noWheelClassName:v,noPanClassName:N,onPaneContextMenu:_,userSelectionActive:T,panOnScroll:H,panOnDrag:B,panOnScrollMode:D,panOnScrollSpeed:A,preventScrolling:I,zoomOnPinch:V,zoomOnScroll:z,zoomOnDoubleClick:L,zoomActivationKeyPressed:O,lib:G,onTransformChange:K,connectionInProgress:U,paneClickDistance:q,selectionOnDrag:R}){T&&!f.isZoomingOrPanning&&y();const X=H&&!O&&!T;a.clickDistance(R?1/0:!ce(q)||q<0?0:q);const Q=X?jr({zoomPanValues:f,noWheelClassName:v,d3Selection:u,d3Zoom:a,panOnScrollMode:D,panOnScrollSpeed:A,zoomOnPinch:V,onPanZoomStart:i,onPanZoom:r,onPanZoomEnd:c}):Br({noWheelClassName:v,preventScrolling:I,d3ZoomHandler:p});if(u.on("wheel.zoom",Q,{passive:!1}),!T){const W=Vr({zoomPanValues:f,onDraggingChange:l,onPanZoomStart:i});a.on("start",W);const Y=Rr({zoomPanValues:f,panOnDrag:B,onPaneContextMenu:!!_,onPanZoom:r,onTransformChange:K});a.on("zoom",Y);const te=Fr({zoomPanValues:f,panOnDrag:B,panOnScroll:H,onPaneContextMenu:_,onPanZoomEnd:c,onDraggingChange:l});a.on("end",te)}const Z=Or({zoomActivationKeyPressed:O,panOnDrag:B,zoomOnScroll:z,panOnScroll:H,zoomOnDoubleClick:L,zoomOnPinch:V,userSelectionActive:T,noPanClassName:N,noWheelClassName:v,lib:G,connectionInProgress:U});a.filter(Z),L?u.on("dblclick.zoom",g):u.on("dblclick.zoom",null)}function y(){a.on("zoom",null)}async function w(v,N,_){const T=mt(v),H=a==null?void 0:a.constrain()(T,N,_);return H&&await x(H),new Promise(B=>B(H))}async function d(v,N){const _=mt(v);return await x(_,N),new Promise(T=>T(_))}function b(v){if(u){const N=mt(v),_=u.property("__zoom");(_.k!==v.zoom||_.x!==v.x||_.y!==v.y)&&(a==null||a.transform(u,N,null,{sync:!0}))}}function M(){const v=u?Ks(u.node()):{x:0,y:0,k:1};return{x:v.x,y:v.y,zoom:v.k}}function E(v,N){return u?new Promise(_=>{a==null||a.interpolate((N==null?void 0:N.interpolate)==="linear"?ht:gt).scaleTo(yt(u,N==null?void 0:N.duration,N==null?void 0:N.ease,()=>_(!0)),v)}):Promise.resolve(!1)}function C(v,N){return u?new Promise(_=>{a==null||a.interpolate((N==null?void 0:N.interpolate)==="linear"?ht:gt).scaleBy(yt(u,N==null?void 0:N.duration,N==null?void 0:N.ease,()=>_(!0)),v)}):Promise.resolve(!1)}function $(v){a==null||a.scaleExtent(v)}function k(v){a==null||a.translateExtent(v)}function j(v){const N=!ce(v)||v<0?0:v;a==null||a.clickDistance(N)}return{update:m,destroy:y,setViewport:d,setViewportConstrained:w,getViewport:M,scaleTo:E,scaleBy:C,setScaleExtent:$,setTranslateExtent:k,syncViewport:b,setClickDistance:j}}var $e;(function(e){e.Line="line",e.Handle="handle"})($e||($e={}));function Wr({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:s,affectsY:r}){const i=e-t,c=n-o,l=[i>0?1:i<0?-1:0,c>0?1:c<0?-1:0];return i&&s&&(l[0]=l[0]*-1),c&&r&&(l[1]=l[1]*-1),l}function sn(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),s=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:s}}function ge(e,t){return Math.max(0,t-e)}function he(e,t){return Math.max(0,e-t)}function Ze(e,t,n){return Math.max(0,t-e,e-n)}function rn(e,t){return e?!t:t}function Xr(e,t,n,o,s,r,i,c){let{affectsX:l,affectsY:f}=t;const{isHorizontal:h,isVertical:a}=t,u=h&&a,{xSnapped:p,ySnapped:g}=n,{minWidth:x,maxWidth:m,minHeight:y,maxHeight:w}=o,{x:d,y:b,width:M,height:E,aspectRatio:C}=e;let $=Math.floor(h?p-e.pointerX:0),k=Math.floor(a?g-e.pointerY:0);const j=M+(l?-$:$),v=E+(f?-k:k),N=-r[0]*M,_=-r[1]*E;let T=Ze(j,x,m),H=Ze(v,y,w);if(i){let A=0,I=0;l&&$<0?A=ge(d+$+N,i[0][0]):!l&&$>0&&(A=he(d+j+N,i[1][0])),f&&k<0?I=ge(b+k+_,i[0][1]):!f&&k>0&&(I=he(b+v+_,i[1][1])),T=Math.max(T,A),H=Math.max(H,I)}if(c){let A=0,I=0;l&&$>0?A=he(d+$,c[0][0]):!l&&$<0&&(A=ge(d+j,c[1][0])),f&&k>0?I=he(b+k,c[0][1]):!f&&k<0&&(I=ge(b+v,c[1][1])),T=Math.max(T,A),H=Math.max(H,I)}if(s){if(h){const A=Ze(j/C,y,w)*C;if(T=Math.max(T,A),i){let I=0;!l&&!f||l&&!f&&u?I=he(b+_+j/C,i[1][1])*C:I=ge(b+_+(l?$:-$)/C,i[0][1])*C,T=Math.max(T,I)}if(c){let I=0;!l&&!f||l&&!f&&u?I=ge(b+j/C,c[1][1])*C:I=he(b+(l?$:-$)/C,c[0][1])*C,T=Math.max(T,I)}}if(a){const A=Ze(v*C,x,m)/C;if(H=Math.max(H,A),i){let I=0;!l&&!f||f&&!l&&u?I=he(d+v*C+N,i[1][0])/C:I=ge(d+(f?k:-k)*C+N,i[0][0])/C,H=Math.max(H,I)}if(c){let I=0;!l&&!f||f&&!l&&u?I=ge(d+v*C,c[1][0])/C:I=he(d+(f?k:-k)*C,c[0][0])/C,H=Math.max(H,I)}}}k=k+(k<0?H:-H),$=$+($<0?T:-T),s&&(u?j>v*C?k=(rn(l,f)?-$:$)/C:$=(rn(l,f)?-k:k)*C:h?(k=$/C,f=l):($=k*C,l=f));const B=l?d+$:d,D=f?b+k:b;return{width:M+(l?-$:$),height:E+(f?-k:k),x:r[0]*$*(l?-1:1)+B,y:r[1]*k*(f?-1:1)+D}}const ao={width:0,height:0,x:0,y:0},Gr={...ao,pointerX:0,pointerY:0,aspectRatio:1};function Zr(e){return[[0,0],[e.measured.width,e.measured.height]]}function Kr(e,t,n){const o=t.position.x+e.position.x,s=t.position.y+e.position.y,r=e.measured.width??0,i=e.measured.height??0,c=n[0]*r,l=n[1]*i;return[[o-c,s-l],[o+r-c,s+i-l]]}function Ur({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:s}){const r=nt(e);let i={controlDirection:sn("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function c({controlPosition:f,boundaries:h,keepAspectRatio:a,resizeDirection:u,onResizeStart:p,onResize:g,onResizeEnd:x,shouldResize:m}){let y={...ao},w={...Gr};i={boundaries:h,resizeDirection:u,keepAspectRatio:a,controlDirection:sn(f)};let d,b=null,M=[],E,C,$,k=!1;const j=Ln().on("start",v=>{const{nodeLookup:N,transform:_,snapGrid:T,snapToGrid:H,nodeOrigin:B,paneDomNode:D}=n();if(d=N.get(t),!d)return;b=(D==null?void 0:D.getBoundingClientRect())??null;const{xSnapped:A,ySnapped:I}=De(v.sourceEvent,{transform:_,snapGrid:T,snapToGrid:H,containerBounds:b});y={width:d.measured.width??0,height:d.measured.height??0,x:d.position.x??0,y:d.position.y??0},w={...y,pointerX:A,pointerY:I,aspectRatio:y.width/y.height},E=void 0,d.parentId&&(d.extent==="parent"||d.expandParent)&&(E=N.get(d.parentId),C=E&&d.extent==="parent"?Zr(E):void 0),M=[],$=void 0;for(const[V,z]of N)if(z.parentId===t&&(M.push({id:V,position:{...z.position},extent:z.extent}),z.extent==="parent"||z.expandParent)){const L=Kr(z,d,z.origin??B);$?$=[[Math.min(L[0][0],$[0][0]),Math.min(L[0][1],$[0][1])],[Math.max(L[1][0],$[1][0]),Math.max(L[1][1],$[1][1])]]:$=L}p==null||p(v,{...y})}).on("drag",v=>{const{transform:N,snapGrid:_,snapToGrid:T,nodeOrigin:H}=n(),B=De(v.sourceEvent,{transform:N,snapGrid:_,snapToGrid:T,containerBounds:b}),D=[];if(!d)return;const{x:A,y:I,width:V,height:z}=y,L={},O=d.origin??H,{width:G,height:K,x:U,y:q}=Xr(w,i.controlDirection,B,i.boundaries,i.keepAspectRatio,O,C,$),R=G!==V,X=K!==z,Q=U!==A&&R,Z=q!==I&&X;if(!Q&&!Z&&!R&&!X)return;if((Q||Z||O[0]===1||O[1]===1)&&(L.x=Q?U:y.x,L.y=Z?q:y.y,y.x=L.x,y.y=L.y,M.length>0)){const ne=U-A,ee=q-I;for(const ie of M)ie.position={x:ie.position.x-ne+O[0]*(G-V),y:ie.position.y-ee+O[1]*(K-z)},D.push(ie)}if((R||X)&&(L.width=R&&(!i.resizeDirection||i.resizeDirection==="horizontal")?G:y.width,L.height=X&&(!i.resizeDirection||i.resizeDirection==="vertical")?K:y.height,y.width=L.width,y.height=L.height),E&&d.expandParent){const ne=O[0]*(L.width??0);L.x&&L.x<ne&&(y.x=ne,w.x=w.x-(L.x-ne));const ee=O[1]*(L.height??0);L.y&&L.y<ee&&(y.y=ee,w.y=w.y-(L.y-ee))}const W=Wr({width:y.width,prevWidth:V,height:y.height,prevHeight:z,affectsX:i.controlDirection.affectsX,affectsY:i.controlDirection.affectsY}),Y={...y,direction:W};(m==null?void 0:m(v,Y))!==!1&&(k=!0,g==null||g(v,Y),o(L,D))}).on("end",v=>{k&&(x==null||x(v,{...y}),s==null||s({...y}),k=!1)});r.call(j)}function l(){r.on(".drag",null)}return{update:c,destroy:l}}const qr={},cn=e=>{let t;const n=new Set,o=(h,a)=>{const u=typeof h=="function"?h(t):h;if(!Object.is(u,t)){const p=t;t=a??(typeof u!="object"||u===null)?u:Object.assign({},t,u),n.forEach(g=>g(t,p))}},s=()=>t,l={setState:o,getState:s,getInitialState:()=>f,subscribe:h=>(n.add(h),()=>n.delete(h)),destroy:()=>{(qr?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},f=t=e(o,s,l);return l},Qr=e=>e?cn(e):cn,{useDebugValue:Jr}=qs,{useSyncExternalStoreWithSelector:ei}=Us,ti=e=>e;function lo(e,t=ti,n){const o=ei(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Jr(o),o}const an=(e,t)=>{const n=Qr(e),o=(s,r=t)=>lo(n,s,r);return Object.assign(o,n),o},ni=(e,t)=>e?an(e,t):an;function oe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const it=P.createContext(null),oi=it.Provider,uo=le.error001();function J(e,t){const n=P.useContext(it);if(n===null)throw new Error(uo);return lo(n,e,t)}function se(){const e=P.useContext(it);if(e===null)throw new Error(uo);return P.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const ln={display:"none"},si={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},fo="react-flow__node-desc",go="react-flow__edge-desc",ri="react-flow__aria-live",ii=e=>e.ariaLiveMessage,ci=e=>e.ariaLabelConfig;function ai({rfId:e}){const t=J(ii);return S.jsx("div",{id:`${ri}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:si,children:t})}function li({rfId:e,disableKeyboardA11y:t}){const n=J(ci);return S.jsxs(S.Fragment,{children:[S.jsx("div",{id:`${fo}-${e}`,style:ln,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),S.jsx("div",{id:`${go}-${e}`,style:ln,children:n["edge.a11yDescription.default"]}),!t&&S.jsx(ai,{rfId:e})]})}const ct=P.forwardRef(({position:e="top-left",children:t,className:n,style:o,...s},r)=>{const i=`${e}`.split("-");return S.jsx("div",{className:re(["react-flow__panel",n,...i]),style:o,ref:r,...s,children:t})});ct.displayName="Panel";function ui({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:S.jsx(ct,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:S.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const di=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},Ke=e=>e.id;function fi(e,t){return oe(e.selectedNodes.map(Ke),t.selectedNodes.map(Ke))&&oe(e.selectedEdges.map(Ke),t.selectedEdges.map(Ke))}function gi({onSelectionChange:e}){const t=se(),{selectedNodes:n,selectedEdges:o}=J(di,fi);return P.useEffect(()=>{const s={nodes:n,edges:o};e==null||e(s),t.getState().onSelectionChangeHandlers.forEach(r=>r(s))},[n,o,e]),null}const hi=e=>!!e.onSelectionChangeHandlers;function pi({onSelectionChange:e}){const t=J(hi);return e||t?S.jsx(gi,{onSelectionChange:e}):null}const ho=[0,0],mi={x:0,y:0,zoom:1},yi=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig","zIndexMode"],un=[...yi,"rfId"],xi=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),dn={translateExtent:Te,nodeOrigin:ho,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function wi(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:s,setTranslateExtent:r,setNodeExtent:i,reset:c,setDefaultNodesAndEdges:l}=J(xi,oe),f=se();P.useEffect(()=>(l(e.defaultNodes,e.defaultEdges),()=>{h.current=dn,c()}),[]);const h=P.useRef(dn);return P.useEffect(()=>{for(const a of un){const u=e[a],p=h.current[a];u!==p&&(typeof e[a]>"u"||(a==="nodes"?t(u):a==="edges"?n(u):a==="minZoom"?o(u):a==="maxZoom"?s(u):a==="translateExtent"?r(u):a==="nodeExtent"?i(u):a==="ariaLabelConfig"?f.setState({ariaLabelConfig:ar(u)}):a==="fitView"?f.setState({fitViewQueued:u}):a==="fitViewOptions"?f.setState({fitViewOptions:u}):f.setState({[a]:u})))}h.current=e},un.map(a=>e[a])),null}function fn(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function bi(e){var o;const[t,n]=P.useState(e==="system"?null:e);return P.useEffect(()=>{if(e!=="system"){n(e);return}const s=fn(),r=()=>n(s!=null&&s.matches?"dark":"light");return r(),s==null||s.addEventListener("change",r),()=>{s==null||s.removeEventListener("change",r)}},[e]),t!==null?t:(o=fn())!=null&&o.matches?"dark":"light"}const gn=typeof document<"u"?document:null;function Ve(e=null,t={target:gn,actInsideInputWithModifier:!0}){const[n,o]=P.useState(!1),s=P.useRef(!1),r=P.useRef(new Set([])),[i,c]=P.useMemo(()=>{if(e!==null){const f=(Array.isArray(e)?e:[e]).filter(a=>typeof a=="string").map(a=>a.replace("+",`
`).replace(`

`,`
+`).split(`
`)),h=f.reduce((a,u)=>a.concat(...u),[]);return[f,h]}return[[],[]]},[e]);return P.useEffect(()=>{const l=(t==null?void 0:t.target)??gn,f=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const h=p=>{var m,y;if(s.current=p.ctrlKey||p.metaKey||p.shiftKey||p.altKey,(!s.current||s.current&&!f)&&Xn(p))return!1;const x=pn(p.code,c);if(r.current.add(p[x]),hn(i,r.current,!1)){const w=((y=(m=p.composedPath)==null?void 0:m.call(p))==null?void 0:y[0])||p.target,d=(w==null?void 0:w.nodeName)==="BUTTON"||(w==null?void 0:w.nodeName)==="A";t.preventDefault!==!1&&(s.current||!d)&&p.preventDefault(),o(!0)}},a=p=>{const g=pn(p.code,c);hn(i,r.current,!0)?(o(!1),r.current.clear()):r.current.delete(p[g]),p.key==="Meta"&&r.current.clear(),s.current=!1},u=()=>{r.current.clear(),o(!1)};return l==null||l.addEventListener("keydown",h),l==null||l.addEventListener("keyup",a),window.addEventListener("blur",u),window.addEventListener("contextmenu",u),()=>{l==null||l.removeEventListener("keydown",h),l==null||l.removeEventListener("keyup",a),window.removeEventListener("blur",u),window.removeEventListener("contextmenu",u)}}},[e,o]),n}function hn(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function pn(e,t){return t.includes(e)?"code":"key"}const Ei=()=>{const e=se();return P.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,s,r],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??o,y:t.y??s,zoom:t.zoom??r},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{const{width:o,height:s,minZoom:r,maxZoom:i,panZoom:c}=e.getState(),l=Pt(t,o,s,r,i,(n==null?void 0:n.padding)??.1);return c?(await c.setViewport(l,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:s,snapToGrid:r,domNode:i}=e.getState();if(!i)return t;const{x:c,y:l}=i.getBoundingClientRect(),f={x:t.x-c,y:t.y-l},h=n.snapGrid??s,a=n.snapToGrid??r;return Ye(f,o,a,h)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:s,y:r}=o.getBoundingClientRect(),i=Je(t,n);return{x:i.x+s,y:i.y+r}}}),[])};function po(e,t){const n=[],o=new Map,s=[];for(const r of e)if(r.type==="add"){s.push(r);continue}else if(r.type==="remove"||r.type==="replace")o.set(r.id,[r]);else{const i=o.get(r.id);i?i.push(r):o.set(r.id,[r])}for(const r of t){const i=o.get(r.id);if(!i){n.push(r);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const c={...r};for(const l of i)vi(l,c);n.push(c)}return s.length&&s.forEach(r=>{r.index!==void 0?n.splice(r.index,0,{...r.item}):n.push({...r.item})}),n}function vi(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured={...e.dimensions},e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function mo(e,t){return po(e,t)}function yo(e,t){return po(e,t)}function xe(e,t){return{id:e,type:"select",selected:t}}function Ce(e,t=new Set,n=!1){const o=[];for(const[s,r]of e){const i=t.has(s);!(r.selected===void 0&&!i)&&r.selected!==i&&(n&&(r.selected=i),o.push(xe(r.id,i)))}return o}function mn({items:e=[],lookup:t}){var s;const n=[],o=new Map(e.map(r=>[r.id,r]));for(const[r,i]of e.entries()){const c=t.get(i.id),l=((s=c==null?void 0:c.internals)==null?void 0:s.userNode)??c;l!==void 0&&l!==i&&n.push({id:i.id,item:i,type:"replace"}),l===void 0&&n.push({item:i,type:"add",index:r})}for(const[r]of t)o.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function yn(e){return{id:e.id,type:"remove"}}const xn=e=>Qs(e),Si=e=>jn(e);function xo(e){return P.forwardRef(e)}const Ni=typeof window<"u"?P.useLayoutEffect:P.useEffect;function wn(e){const[t,n]=P.useState(BigInt(0)),[o]=P.useState(()=>Ci(()=>n(s=>s+BigInt(1))));return Ni(()=>{const s=o.get();s.length&&(e(s),o.reset())},[t]),o}function Ci(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const wo=P.createContext(null);function Mi({children:e}){const t=se(),n=P.useCallback(c=>{const{nodes:l=[],setNodes:f,hasDefaultNodes:h,onNodesChange:a,nodeLookup:u,fitViewQueued:p,onNodesChangeMiddlewareMap:g}=t.getState();let x=l;for(const y of c)x=typeof y=="function"?y(x):y;let m=mn({items:x,lookup:u});for(const y of g.values())m=y(m);h&&f(x),m.length>0?a==null||a(m):p&&window.requestAnimationFrame(()=>{const{fitViewQueued:y,nodes:w,setNodes:d}=t.getState();y&&d(w)})},[]),o=wn(n),s=P.useCallback(c=>{const{edges:l=[],setEdges:f,hasDefaultEdges:h,onEdgesChange:a,edgeLookup:u}=t.getState();let p=l;for(const g of c)p=typeof g=="function"?g(p):g;h?f(p):a&&a(mn({items:p,lookup:u}))},[]),r=wn(s),i=P.useMemo(()=>({nodeQueue:o,edgeQueue:r}),[]);return S.jsx(wo.Provider,{value:i,children:e})}function Ii(){const e=P.useContext(wo);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Pi=e=>!!e.panZoom;function Dt(){const e=Ei(),t=se(),n=Ii(),o=J(Pi),s=P.useMemo(()=>{const r=a=>t.getState().nodeLookup.get(a),i=a=>{n.nodeQueue.push(a)},c=a=>{n.edgeQueue.push(a)},l=a=>{var y,w;const{nodeLookup:u,nodeOrigin:p}=t.getState(),g=xn(a)?a:u.get(a.id),x=g.parentId?Yn(g.position,g.measured,g.parentId,u,p):g.position,m={...g,position:x,width:((y=g.measured)==null?void 0:y.width)??g.width,height:((w=g.measured)==null?void 0:w.height)??g.height};return Pe(m)},f=(a,u,p={replace:!1})=>{i(g=>g.map(x=>{if(x.id===a){const m=typeof u=="function"?u(x):u;return p.replace&&xn(m)?m:{...x,...m}}return x}))},h=(a,u,p={replace:!1})=>{c(g=>g.map(x=>{if(x.id===a){const m=typeof u=="function"?u(x):u;return p.replace&&Si(m)?m:{...x,...m}}return x}))};return{getNodes:()=>t.getState().nodes.map(a=>({...a})),getNode:a=>{var u;return(u=r(a))==null?void 0:u.internals.userNode},getInternalNode:r,getEdges:()=>{const{edges:a=[]}=t.getState();return a.map(u=>({...u}))},getEdge:a=>t.getState().edgeLookup.get(a),setNodes:i,setEdges:c,addNodes:a=>{const u=Array.isArray(a)?a:[a];n.nodeQueue.push(p=>[...p,...u])},addEdges:a=>{const u=Array.isArray(a)?a:[a];n.edgeQueue.push(p=>[...p,...u])},toObject:()=>{const{nodes:a=[],edges:u=[],transform:p}=t.getState(),[g,x,m]=p;return{nodes:a.map(y=>({...y})),edges:u.map(y=>({...y})),viewport:{x:g,y:x,zoom:m}}},deleteElements:async({nodes:a=[],edges:u=[]})=>{const{nodes:p,edges:g,onNodesDelete:x,onEdgesDelete:m,triggerNodeChanges:y,triggerEdgeChanges:w,onDelete:d,onBeforeDelete:b}=t.getState(),{nodes:M,edges:E}=await or({nodesToRemove:a,edgesToRemove:u,nodes:p,edges:g,onBeforeDelete:b}),C=E.length>0,$=M.length>0;if(C){const k=E.map(yn);m==null||m(E),w(k)}if($){const k=M.map(yn);x==null||x(M),y(k)}return($||C)&&(d==null||d({nodes:M,edges:E})),{deletedNodes:M,deletedEdges:E}},getIntersectingNodes:(a,u=!0,p)=>{const g=Gt(a),x=g?a:l(a),m=p!==void 0;return x?(p||t.getState().nodes).filter(y=>{const w=t.getState().nodeLookup.get(y.id);if(w&&!g&&(y.id===a.id||!w.internals.positionAbsolute))return!1;const d=Pe(m?y:w),b=je(d,x);return u&&b>0||b>=d.width*d.height||b>=x.width*x.height}):[]},isNodeIntersecting:(a,u,p=!0)=>{const x=Gt(a)?a:l(a);if(!x)return!1;const m=je(x,u);return p&&m>0||m>=u.width*u.height||m>=x.width*x.height},updateNode:f,updateNodeData:(a,u,p={replace:!1})=>{f(a,g=>{const x=typeof u=="function"?u(g):u;return p.replace?{...g,data:x}:{...g,data:{...g.data,...x}}},p)},updateEdge:h,updateEdgeData:(a,u,p={replace:!1})=>{h(a,g=>{const x=typeof u=="function"?u(g):u;return p.replace?{...g,data:x}:{...g,data:{...g.data,...x}}},p)},getNodesBounds:a=>{const{nodeLookup:u,nodeOrigin:p}=t.getState();return Js(a,{nodeLookup:u,nodeOrigin:p})},getHandleConnections:({type:a,id:u,nodeId:p})=>{var g;return Array.from(((g=t.getState().connectionLookup.get(`${p}-${a}${u?`-${u}`:""}`))==null?void 0:g.values())??[])},getNodeConnections:({type:a,handleId:u,nodeId:p})=>{var g;return Array.from(((g=t.getState().connectionLookup.get(`${p}${a?u?`-${a}-${u}`:`-${a}`:""}`))==null?void 0:g.values())??[])},fitView:async a=>{const u=t.getState().fitViewResolver??cr();return t.setState({fitViewQueued:!0,fitViewOptions:a,fitViewResolver:u}),n.nodeQueue.push(p=>[...p]),u.promise}}},[]);return P.useMemo(()=>({...s,...e,viewportInitialized:o}),[o])}const bn=e=>e.selected,ki=typeof window<"u"?window:void 0;function $i({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=se(),{deleteElements:o}=Dt(),s=Ve(e,{actInsideInputWithModifier:!1}),r=Ve(t,{target:ki});P.useEffect(()=>{if(s){const{edges:i,nodes:c}=n.getState();o({nodes:c.filter(bn),edges:i.filter(bn)}),n.setState({nodesSelectionActive:!1})}},[s]),P.useEffect(()=>{n.setState({multiSelectionActive:r})},[r])}function Ai(e){const t=se();P.useEffect(()=>{const n=()=>{var s,r,i,c;if(!e.current||!(((r=(s=e.current).checkVisibility)==null?void 0:r.call(s))??!0))return!1;const o=kt(e.current);(o.height===0||o.width===0)&&((c=(i=t.getState()).onError)==null||c.call(i,"004",le.error004())),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const at={position:"absolute",width:"100%",height:"100%",top:0,left:0},_i=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function Li({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:s=.5,panOnScrollMode:r=we.Free,zoomOnDoubleClick:i=!0,panOnDrag:c=!0,defaultViewport:l,translateExtent:f,minZoom:h,maxZoom:a,zoomActivationKeyCode:u,preventScrolling:p=!0,children:g,noWheelClassName:x,noPanClassName:m,onViewportChange:y,isControlledViewport:w,paneClickDistance:d,selectionOnDrag:b}){const M=se(),E=P.useRef(null),{userSelectionActive:C,lib:$,connectionInProgress:k}=J(_i,oe),j=Ve(u),v=P.useRef();Ai(E);const N=P.useCallback(_=>{y==null||y({x:_[0],y:_[1],zoom:_[2]}),w||M.setState({transform:_})},[y,w]);return P.useEffect(()=>{if(E.current){v.current=Yr({domNode:E.current,minZoom:h,maxZoom:a,translateExtent:f,viewport:l,onDraggingChange:B=>M.setState(D=>D.paneDragging===B?D:{paneDragging:B}),onPanZoomStart:(B,D)=>{const{onViewportChangeStart:A,onMoveStart:I}=M.getState();I==null||I(B,D),A==null||A(D)},onPanZoom:(B,D)=>{const{onViewportChange:A,onMove:I}=M.getState();I==null||I(B,D),A==null||A(D)},onPanZoomEnd:(B,D)=>{const{onViewportChangeEnd:A,onMoveEnd:I}=M.getState();I==null||I(B,D),A==null||A(D)}});const{x:_,y:T,zoom:H}=v.current.getViewport();return M.setState({panZoom:v.current,transform:[_,T,H],domNode:E.current.closest(".react-flow")}),()=>{var B;(B=v.current)==null||B.destroy()}}},[]),P.useEffect(()=>{var _;(_=v.current)==null||_.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:s,panOnScrollMode:r,zoomOnDoubleClick:i,panOnDrag:c,zoomActivationKeyPressed:j,preventScrolling:p,noPanClassName:m,userSelectionActive:C,noWheelClassName:x,lib:$,onTransformChange:N,connectionInProgress:k,selectionOnDrag:b,paneClickDistance:d})},[e,t,n,o,s,r,i,c,j,p,m,C,x,$,N,k,b,d]),S.jsx("div",{className:"react-flow__renderer",ref:E,style:at,children:g})}const Hi=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Di(){const{userSelectionActive:e,userSelectionRect:t}=J(Hi,oe);return e&&t?S.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const xt=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Ti=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function zi({isSelecting:e,selectionKeyPressed:t,selectionMode:n=ze.Full,panOnDrag:o,paneClickDistance:s,selectionOnDrag:r,onSelectionStart:i,onSelectionEnd:c,onPaneClick:l,onPaneContextMenu:f,onPaneScroll:h,onPaneMouseEnter:a,onPaneMouseMove:u,onPaneMouseLeave:p,children:g}){const x=se(),{userSelectionActive:m,elementsSelectable:y,dragging:w,connectionInProgress:d}=J(Ti,oe),b=y&&(e||m),M=P.useRef(null),E=P.useRef(),C=P.useRef(new Set),$=P.useRef(new Set),k=P.useRef(!1),j=A=>{if(k.current||d){k.current=!1;return}l==null||l(A),x.getState().resetSelectedElements(),x.setState({nodesSelectionActive:!1})},v=A=>{if(Array.isArray(o)&&(o!=null&&o.includes(2))){A.preventDefault();return}f==null||f(A)},N=h?A=>h(A):void 0,_=A=>{k.current&&(A.stopPropagation(),k.current=!1)},T=A=>{var K,U;const{domNode:I}=x.getState();if(E.current=I==null?void 0:I.getBoundingClientRect(),!E.current)return;const V=A.target===M.current;if(!V&&!!A.target.closest(".nokey")||!e||!(r&&V||t)||A.button!==0||!A.isPrimary)return;(U=(K=A.target)==null?void 0:K.setPointerCapture)==null||U.call(K,A.pointerId),k.current=!1;const{x:O,y:G}=ae(A.nativeEvent,E.current);x.setState({userSelectionRect:{width:0,height:0,startX:O,startY:G,x:O,y:G}}),V||(A.stopPropagation(),A.preventDefault())},H=A=>{const{userSelectionRect:I,transform:V,nodeLookup:z,edgeLookup:L,connectionLookup:O,triggerNodeChanges:G,triggerEdgeChanges:K,defaultEdgeOptions:U,resetSelectedElements:q}=x.getState();if(!E.current||!I)return;const{x:R,y:X}=ae(A.nativeEvent,E.current),{startX:Q,startY:Z}=I;if(!k.current){const ee=t?0:s;if(Math.hypot(R-Q,X-Z)<=ee)return;q(),i==null||i(A)}k.current=!0;const W={startX:Q,startY:Z,x:R<Q?R:Q,y:X<Z?X:Z,width:Math.abs(R-Q),height:Math.abs(X-Z)},Y=C.current,te=$.current;C.current=new Set(It(z,W,V,n===ze.Partial,!0).map(ee=>ee.id)),$.current=new Set;const ne=(U==null?void 0:U.selectable)??!0;for(const ee of C.current){const ie=O.get(ee);if(ie)for(const{edgeId:fe}of ie.values()){const ue=L.get(fe);ue&&(ue.selectable??ne)&&$.current.add(fe)}}if(!Zt(Y,C.current)){const ee=Ce(z,C.current,!0);G(ee)}if(!Zt(te,$.current)){const ee=Ce(L,$.current);K(ee)}x.setState({userSelectionRect:W,userSelectionActive:!0,nodesSelectionActive:!1})},B=A=>{var I,V;A.button===0&&((V=(I=A.target)==null?void 0:I.releasePointerCapture)==null||V.call(I,A.pointerId),!m&&A.target===M.current&&x.getState().userSelectionRect&&(j==null||j(A)),x.setState({userSelectionActive:!1,userSelectionRect:null}),k.current&&(c==null||c(A),x.setState({nodesSelectionActive:C.current.size>0})))},D=o===!0||Array.isArray(o)&&o.includes(0);return S.jsxs("div",{className:re(["react-flow__pane",{draggable:D,dragging:w,selection:e}]),onClick:b?void 0:xt(j,M),onContextMenu:xt(v,M),onWheel:xt(N,M),onPointerEnter:b?void 0:a,onPointerMove:b?H:u,onPointerUp:b?B:void 0,onPointerDownCapture:b?T:void 0,onClickCapture:b?_:void 0,onPointerLeave:p,ref:M,style:at,children:[g,S.jsx(Di,{})]})}function Ct({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:r,multiSelectionActive:i,nodeLookup:c,onError:l}=t.getState(),f=c.get(e);if(!f){l==null||l("012",le.error012(e));return}t.setState({nodesSelectionActive:!1}),f.selected?(n||f.selected&&i)&&(r({nodes:[f],edges:[]}),requestAnimationFrame(()=>{var h;return(h=o==null?void 0:o.current)==null?void 0:h.blur()})):s([e])}function bo({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:r,nodeClickDistance:i}){const c=se(),[l,f]=P.useState(!1),h=P.useRef();return P.useEffect(()=>{h.current=$r({getStoreItems:()=>c.getState(),onNodeMouseDown:a=>{Ct({id:a,store:c,nodeRef:e})},onDragStart:()=>{f(!0)},onDragStop:()=>{f(!1)}})},[]),P.useEffect(()=>{if(!(t||!e.current||!h.current))return h.current.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:r,nodeId:s,nodeClickDistance:i}),()=>{var a;(a=h.current)==null||a.destroy()}},[n,o,t,r,e,s,i]),l}const ji=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Eo(){const e=se();return P.useCallback(n=>{const{nodeExtent:o,snapToGrid:s,snapGrid:r,nodesDraggable:i,onError:c,updateNodePositions:l,nodeLookup:f,nodeOrigin:h}=e.getState(),a=new Map,u=ji(i),p=s?r[0]:5,g=s?r[1]:5,x=n.direction.x*p*n.factor,m=n.direction.y*g*n.factor;for(const[,y]of f){if(!u(y))continue;let w={x:y.internals.positionAbsolute.x+x,y:y.internals.positionAbsolute.y+m};s&&(w=Oe(w,r));const{position:d,positionAbsolute:b}=Bn({nodeId:y.id,nextPosition:w,nodeLookup:f,nodeExtent:o,nodeOrigin:h,onError:c});y.position=d,y.internals.positionAbsolute=b,a.set(y.id,y)}l(a)},[])}const Tt=P.createContext(null),Bi=Tt.Provider;Tt.Consumer;const vo=()=>P.useContext(Tt),Vi=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Ri=(e,t,n)=>o=>{const{connectionClickStartHandle:s,connectionMode:r,connection:i}=o,{fromHandle:c,toHandle:l,isValid:f}=i,h=(l==null?void 0:l.nodeId)===e&&(l==null?void 0:l.id)===t&&(l==null?void 0:l.type)===n;return{connectingFrom:(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n,connectingTo:h,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,isPossibleEndHandle:r===Me.Strict?(c==null?void 0:c.type)!==n:e!==(c==null?void 0:c.nodeId)||t!==(c==null?void 0:c.id),connectionInProcess:!!c,clickConnectionInProcess:!!s,valid:h&&f}};function Fi({type:e="source",position:t=F.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:r=!0,id:i,onConnect:c,children:l,className:f,onMouseDown:h,onTouchStart:a,...u},p){var H,B;const g=i||null,x=e==="target",m=se(),y=vo(),{connectOnClick:w,noPanClassName:d,rfId:b}=J(Vi,oe),{connectingFrom:M,connectingTo:E,clickConnecting:C,isPossibleEndHandle:$,connectionInProcess:k,clickConnectionInProcess:j,valid:v}=J(Ri(y,g,e),oe);y||(B=(H=m.getState()).onError)==null||B.call(H,"010",le.error010());const N=D=>{const{defaultEdgeOptions:A,onConnect:I,hasDefaultEdges:V}=m.getState(),z={...A,...D};if(V){const{edges:L,setEdges:O}=m.getState();O(hr(z,L))}I==null||I(z),c==null||c(z)},_=D=>{if(!y)return;const A=Gn(D.nativeEvent);if(s&&(A&&D.button===0||!A)){const I=m.getState();Nt.onPointerDown(D.nativeEvent,{handleDomNode:D.currentTarget,autoPanOnConnect:I.autoPanOnConnect,connectionMode:I.connectionMode,connectionRadius:I.connectionRadius,domNode:I.domNode,nodeLookup:I.nodeLookup,lib:I.lib,isTarget:x,handleId:g,nodeId:y,flowId:I.rfId,panBy:I.panBy,cancelConnection:I.cancelConnection,onConnectStart:I.onConnectStart,onConnectEnd:(...V)=>{var z,L;return(L=(z=m.getState()).onConnectEnd)==null?void 0:L.call(z,...V)},updateConnection:I.updateConnection,onConnect:N,isValidConnection:n||((...V)=>{var z,L;return((L=(z=m.getState()).isValidConnection)==null?void 0:L.call(z,...V))??!0}),getTransform:()=>m.getState().transform,getFromHandle:()=>m.getState().connection.fromHandle,autoPanSpeed:I.autoPanSpeed,dragThreshold:I.connectionDragThreshold})}A?h==null||h(D):a==null||a(D)},T=D=>{const{onClickConnectStart:A,onClickConnectEnd:I,connectionClickStartHandle:V,connectionMode:z,isValidConnection:L,lib:O,rfId:G,nodeLookup:K,connection:U}=m.getState();if(!y||!V&&!s)return;if(!V){A==null||A(D.nativeEvent,{nodeId:y,handleId:g,handleType:e}),m.setState({connectionClickStartHandle:{nodeId:y,type:e,id:g}});return}const q=Wn(D.target),R=n||L,{connection:X,isValid:Q}=Nt.isValid(D.nativeEvent,{handle:{nodeId:y,id:g,type:e},connectionMode:z,fromNodeId:V.nodeId,fromHandleId:V.id||null,fromType:V.type,isValidConnection:R,flowId:G,doc:q,lib:O,nodeLookup:K});Q&&X&&N(X);const Z=structuredClone(U);delete Z.inProgress,Z.toPosition=Z.toHandle?Z.toHandle.position:null,I==null||I(D,Z),m.setState({connectionClickStartHandle:null})};return S.jsx("div",{"data-handleid":g,"data-nodeid":y,"data-handlepos":t,"data-id":`${b}-${y}-${g}-${e}`,className:re(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",d,f,{source:!x,target:x,connectable:o,connectablestart:s,connectableend:r,clickconnecting:C,connectingfrom:M,connectingto:E,valid:v,connectionindicator:o&&(!k||$)&&(k||j?r:s)}]),onMouseDown:_,onTouchStart:_,onClick:w?T:void 0,ref:p,...u,children:l})}const et=P.memo(xo(Fi));function Oi({data:e,isConnectable:t,sourcePosition:n=F.Bottom}){return S.jsxs(S.Fragment,{children:[e==null?void 0:e.label,S.jsx(et,{type:"source",position:n,isConnectable:t})]})}function Yi({data:e,isConnectable:t,targetPosition:n=F.Top,sourcePosition:o=F.Bottom}){return S.jsxs(S.Fragment,{children:[S.jsx(et,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,S.jsx(et,{type:"source",position:o,isConnectable:t})]})}function Wi(){return null}function Xi({data:e,isConnectable:t,targetPosition:n=F.Top}){return S.jsxs(S.Fragment,{children:[S.jsx(et,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const tt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},En={input:Oi,default:Yi,output:Xi,group:Wi};function Gi(e){var t,n,o,s;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((o=e.style)==null?void 0:o.width),height:e.height??((s=e.style)==null?void 0:s.height)}}const Zi=e=>{const{width:t,height:n,x:o,y:s}=Fe(e.nodeLookup,{filter:r=>!!r.selected});return{width:ce(t)?t:null,height:ce(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${s}px)`}};function Ki({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=se(),{width:s,height:r,transformString:i,userSelectionActive:c}=J(Zi,oe),l=Eo(),f=P.useRef(null);P.useEffect(()=>{var p;n||(p=f.current)==null||p.focus({preventScroll:!0})},[n]);const h=!c&&s!==null&&r!==null;if(bo({nodeRef:f,disabled:!h}),!h)return null;const a=e?p=>{const g=o.getState().nodes.filter(x=>x.selected);e(p,g)}:void 0,u=p=>{Object.prototype.hasOwnProperty.call(tt,p.key)&&(p.preventDefault(),l({direction:tt[p.key],factor:p.shiftKey?4:1}))};return S.jsx("div",{className:re(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:S.jsx("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:a,tabIndex:n?void 0:-1,onKeyDown:n?void 0:u,style:{width:s,height:r}})})}const vn=typeof window<"u"?window:void 0,Ui=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function So({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,paneClickDistance:c,deleteKeyCode:l,selectionKeyCode:f,selectionOnDrag:h,selectionMode:a,onSelectionStart:u,onSelectionEnd:p,multiSelectionKeyCode:g,panActivationKeyCode:x,zoomActivationKeyCode:m,elementsSelectable:y,zoomOnScroll:w,zoomOnPinch:d,panOnScroll:b,panOnScrollSpeed:M,panOnScrollMode:E,zoomOnDoubleClick:C,panOnDrag:$,defaultViewport:k,translateExtent:j,minZoom:v,maxZoom:N,preventScrolling:_,onSelectionContextMenu:T,noWheelClassName:H,noPanClassName:B,disableKeyboardA11y:D,onViewportChange:A,isControlledViewport:I}){const{nodesSelectionActive:V,userSelectionActive:z}=J(Ui,oe),L=Ve(f,{target:vn}),O=Ve(x,{target:vn}),G=O||$,K=O||b,U=h&&G!==!0,q=L||z||U;return $i({deleteKeyCode:l,multiSelectionKeyCode:g}),S.jsx(Li,{onPaneContextMenu:r,elementsSelectable:y,zoomOnScroll:w,zoomOnPinch:d,panOnScroll:K,panOnScrollSpeed:M,panOnScrollMode:E,zoomOnDoubleClick:C,panOnDrag:!L&&G,defaultViewport:k,translateExtent:j,minZoom:v,maxZoom:N,zoomActivationKeyCode:m,preventScrolling:_,noWheelClassName:H,noPanClassName:B,onViewportChange:A,isControlledViewport:I,paneClickDistance:c,selectionOnDrag:U,children:S.jsxs(zi,{onSelectionStart:u,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,panOnDrag:G,isSelecting:!!q,selectionMode:a,selectionKeyPressed:L,paneClickDistance:c,selectionOnDrag:U,children:[e,V&&S.jsx(Ki,{onSelectionContextMenu:T,noPanClassName:B,disableKeyboardA11y:D})]})})}So.displayName="FlowRenderer";const qi=P.memo(So),Qi=e=>t=>e?It(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Ji(e){return J(P.useCallback(Qi(e),[e]),oe)}const ec=e=>e.updateNodeInternals;function tc(){const e=J(ec),[t]=P.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(s=>{const r=s.target.getAttribute("data-id");o.set(r,{id:r,nodeElement:s.target,force:!0})}),e(o)}));return P.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function nc({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const s=se(),r=P.useRef(null),i=P.useRef(null),c=P.useRef(e.sourcePosition),l=P.useRef(e.targetPosition),f=P.useRef(t),h=n&&!!e.internals.handleBounds;return P.useEffect(()=>{r.current&&!e.hidden&&(!h||i.current!==r.current)&&(i.current&&(o==null||o.unobserve(i.current)),o==null||o.observe(r.current),i.current=r.current)},[h,e.hidden]),P.useEffect(()=>()=>{i.current&&(o==null||o.unobserve(i.current),i.current=null)},[]),P.useEffect(()=>{if(r.current){const a=f.current!==t,u=c.current!==e.sourcePosition,p=l.current!==e.targetPosition;(a||u||p)&&(f.current=t,c.current=e.sourcePosition,l.current=e.targetPosition,s.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:r.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),r}function oc({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:s,onContextMenu:r,onDoubleClick:i,nodesDraggable:c,elementsSelectable:l,nodesConnectable:f,nodesFocusable:h,resizeObserver:a,noDragClassName:u,noPanClassName:p,disableKeyboardA11y:g,rfId:x,nodeTypes:m,nodeClickDistance:y,onError:w}){const{node:d,internals:b,isParent:M}=J(R=>{const X=R.nodeLookup.get(e),Q=R.parentLookup.has(e);return{node:X,internals:X.internals,isParent:Q}},oe);let E=d.type||"default",C=(m==null?void 0:m[E])||En[E];C===void 0&&(w==null||w("003",le.error003(E)),E="default",C=(m==null?void 0:m.default)||En.default);const $=!!(d.draggable||c&&typeof d.draggable>"u"),k=!!(d.selectable||l&&typeof d.selectable>"u"),j=!!(d.connectable||f&&typeof d.connectable>"u"),v=!!(d.focusable||h&&typeof d.focusable>"u"),N=se(),_=On(d),T=nc({node:d,nodeType:E,hasDimensions:_,resizeObserver:a}),H=bo({nodeRef:T,disabled:d.hidden||!$,noDragClassName:u,handleSelector:d.dragHandle,nodeId:e,isSelectable:k,nodeClickDistance:y}),B=Eo();if(d.hidden)return null;const D=de(d),A=Gi(d),I=k||$||t||n||o||s,V=n?R=>n(R,{...b.userNode}):void 0,z=o?R=>o(R,{...b.userNode}):void 0,L=s?R=>s(R,{...b.userNode}):void 0,O=r?R=>r(R,{...b.userNode}):void 0,G=i?R=>i(R,{...b.userNode}):void 0,K=R=>{const{selectNodesOnDrag:X,nodeDragThreshold:Q}=N.getState();k&&(!X||!$||Q>0)&&Ct({id:e,store:N,nodeRef:T}),t&&t(R,{...b.userNode})},U=R=>{if(!(Xn(R.nativeEvent)||g)){if(Hn.includes(R.key)&&k){const X=R.key==="Escape";Ct({id:e,store:N,unselect:X,nodeRef:T})}else if($&&d.selected&&Object.prototype.hasOwnProperty.call(tt,R.key)){R.preventDefault();const{ariaLabelConfig:X}=N.getState();N.setState({ariaLiveMessage:X["node.a11yDescription.ariaLiveMessage"]({direction:R.key.replace("Arrow","").toLowerCase(),x:~~b.positionAbsolute.x,y:~~b.positionAbsolute.y})}),B({direction:tt[R.key],factor:R.shiftKey?4:1})}}},q=()=>{var te;if(g||!((te=T.current)!=null&&te.matches(":focus-visible")))return;const{transform:R,width:X,height:Q,autoPanOnNodeFocus:Z,setCenter:W}=N.getState();if(!Z)return;It(new Map([[e,d]]),{x:0,y:0,width:X,height:Q},R,!0).length>0||W(d.position.x+D.width/2,d.position.y+D.height/2,{zoom:R[2]})};return S.jsx("div",{className:re(["react-flow__node",`react-flow__node-${E}`,{[p]:$},d.className,{selected:d.selected,selectable:k,parent:M,draggable:$,dragging:H}]),ref:T,style:{zIndex:b.z,transform:`translate(${b.positionAbsolute.x}px,${b.positionAbsolute.y}px)`,pointerEvents:I?"all":"none",visibility:_?"visible":"hidden",...d.style,...A},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:V,onMouseMove:z,onMouseLeave:L,onContextMenu:O,onClick:K,onDoubleClick:G,onKeyDown:v?U:void 0,tabIndex:v?0:void 0,onFocus:v?q:void 0,role:d.ariaRole??(v?"group":void 0),"aria-roledescription":"node","aria-describedby":g?void 0:`${fo}-${x}`,"aria-label":d.ariaLabel,...d.domAttributes,children:S.jsx(Bi,{value:e,children:S.jsx(C,{id:e,data:d.data,type:E,positionAbsoluteX:b.positionAbsolute.x,positionAbsoluteY:b.positionAbsolute.y,selected:d.selected??!1,selectable:k,draggable:$,deletable:d.deletable??!0,isConnectable:j,sourcePosition:d.sourcePosition,targetPosition:d.targetPosition,dragging:H,dragHandle:d.dragHandle,zIndex:b.z,parentId:d.parentId,...D})})})}var sc=P.memo(oc);const rc=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function No(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,onError:r}=J(rc,oe),i=Ji(e.onlyRenderVisibleElements),c=tc();return S.jsx("div",{className:"react-flow__nodes",style:at,children:i.map(l=>S.jsx(sc,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:c,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,nodeClickDistance:e.nodeClickDistance,onError:r},l))})}No.displayName="NodeRenderer";const ic=P.memo(No);function cc(e){return J(P.useCallback(n=>{if(!e)return n.edges.map(s=>s.id);const o=[];if(n.width&&n.height)for(const s of n.edges){const r=n.nodeLookup.get(s.source),i=n.nodeLookup.get(s.target);r&&i&&dr({sourceNode:r,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&o.push(s.id)}return o},[e]),oe)}const ac=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return S.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},lc=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return S.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Sn={[qe.Arrow]:ac,[qe.ArrowClosed]:lc};function uc(e){const t=se();return P.useMemo(()=>{var s,r;return Object.prototype.hasOwnProperty.call(Sn,e)?Sn[e]:((r=(s=t.getState()).onError)==null||r.call(s,"009",le.error009(e)),null)},[e])}const dc=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:r="strokeWidth",strokeWidth:i,orient:c="auto-start-reverse"})=>{const l=uc(t);return l?S.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:r,orient:c,refX:"0",refY:"0",children:S.jsx(l,{color:n,strokeWidth:i})}):null},Co=({defaultColor:e,rfId:t})=>{const n=J(r=>r.edges),o=J(r=>r.defaultEdgeOptions),s=P.useMemo(()=>wr(n,{id:t,defaultColor:e,defaultMarkerStart:o==null?void 0:o.markerStart,defaultMarkerEnd:o==null?void 0:o.markerEnd}),[n,o,t,e]);return s.length?S.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:S.jsx("defs",{children:s.map(r=>S.jsx(dc,{id:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient},r.id))})}):null};Co.displayName="MarkerDefinitions";var fc=P.memo(Co);function Mo({x:e,y:t,label:n,labelStyle:o,labelShowBg:s=!0,labelBgStyle:r,labelBgPadding:i=[2,4],labelBgBorderRadius:c=2,children:l,className:f,...h}){const[a,u]=P.useState({x:1,y:0,width:0,height:0}),p=re(["react-flow__edge-textwrapper",f]),g=P.useRef(null);return P.useEffect(()=>{if(g.current){const x=g.current.getBBox();u({x:x.x,y:x.y,width:x.width,height:x.height})}},[n]),n?S.jsxs("g",{transform:`translate(${e-a.width/2} ${t-a.height/2})`,className:p,visibility:a.width?"visible":"hidden",...h,children:[s&&S.jsx("rect",{width:a.width+2*i[0],x:-i[0],y:-i[1],height:a.height+2*i[1],className:"react-flow__edge-textbg",style:r,rx:c,ry:c}),S.jsx("text",{className:"react-flow__edge-text",y:a.height/2,dy:"0.3em",ref:g,style:o,children:n}),l]}):null}Mo.displayName="EdgeText";const gc=P.memo(Mo);function lt({path:e,labelX:t,labelY:n,label:o,labelStyle:s,labelShowBg:r,labelBgStyle:i,labelBgPadding:c,labelBgBorderRadius:l,interactionWidth:f=20,...h}){return S.jsxs(S.Fragment,{children:[S.jsx("path",{...h,d:e,fill:"none",className:re(["react-flow__edge-path",h.className])}),f?S.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}):null,o&&ce(t)&&ce(n)?S.jsx(gc,{x:t,y:n,label:o,labelStyle:s,labelShowBg:r,labelBgStyle:i,labelBgPadding:c,labelBgBorderRadius:l}):null]})}function Nn({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===F.Left||e===F.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function Io({sourceX:e,sourceY:t,sourcePosition:n=F.Bottom,targetX:o,targetY:s,targetPosition:r=F.Top}){const[i,c]=Nn({pos:n,x1:e,y1:t,x2:o,y2:s}),[l,f]=Nn({pos:r,x1:o,y1:s,x2:e,y2:t}),[h,a,u,p]=Zn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:i,sourceControlY:c,targetControlX:l,targetControlY:f});return[`M${e},${t} C${i},${c} ${l},${f} ${o},${s}`,h,a,u,p]}function Po(e){return P.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i,targetPosition:c,label:l,labelStyle:f,labelShowBg:h,labelBgStyle:a,labelBgPadding:u,labelBgBorderRadius:p,style:g,markerEnd:x,markerStart:m,interactionWidth:y})=>{const[w,d,b]=Io({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:c}),M=e.isInternal?void 0:t;return S.jsx(lt,{id:M,path:w,labelX:d,labelY:b,label:l,labelStyle:f,labelShowBg:h,labelBgStyle:a,labelBgPadding:u,labelBgBorderRadius:p,style:g,markerEnd:x,markerStart:m,interactionWidth:y})})}const hc=Po({isInternal:!1}),ko=Po({isInternal:!0});hc.displayName="SimpleBezierEdge";ko.displayName="SimpleBezierEdgeInternal";function $o(e){return P.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:c,labelShowBg:l,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:a,style:u,sourcePosition:p=F.Bottom,targetPosition:g=F.Top,markerEnd:x,markerStart:m,pathOptions:y,interactionWidth:w})=>{const[d,b,M]=Et({sourceX:n,sourceY:o,sourcePosition:p,targetX:s,targetY:r,targetPosition:g,borderRadius:y==null?void 0:y.borderRadius,offset:y==null?void 0:y.offset,stepPosition:y==null?void 0:y.stepPosition}),E=e.isInternal?void 0:t;return S.jsx(lt,{id:E,path:d,labelX:b,labelY:M,label:i,labelStyle:c,labelShowBg:l,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:a,style:u,markerEnd:x,markerStart:m,interactionWidth:w})})}const Ao=$o({isInternal:!1}),_o=$o({isInternal:!0});Ao.displayName="SmoothStepEdge";_o.displayName="SmoothStepEdgeInternal";function Lo(e){return P.memo(({id:t,...n})=>{var s;const o=e.isInternal?void 0:t;return S.jsx(Ao,{...n,id:o,pathOptions:P.useMemo(()=>{var r;return{borderRadius:0,offset:(r=n.pathOptions)==null?void 0:r.offset}},[(s=n.pathOptions)==null?void 0:s.offset])})})}const pc=Lo({isInternal:!1}),Ho=Lo({isInternal:!0});pc.displayName="StepEdge";Ho.displayName="StepEdgeInternal";function Do(e){return P.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:c,labelShowBg:l,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:a,style:u,markerEnd:p,markerStart:g,interactionWidth:x})=>{const[m,y,w]=qn({sourceX:n,sourceY:o,targetX:s,targetY:r}),d=e.isInternal?void 0:t;return S.jsx(lt,{id:d,path:m,labelX:y,labelY:w,label:i,labelStyle:c,labelShowBg:l,labelBgStyle:f,labelBgPadding:h,labelBgBorderRadius:a,style:u,markerEnd:p,markerStart:g,interactionWidth:x})})}const mc=Do({isInternal:!1}),To=Do({isInternal:!0});mc.displayName="StraightEdge";To.displayName="StraightEdgeInternal";function zo(e){return P.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i=F.Bottom,targetPosition:c=F.Top,label:l,labelStyle:f,labelShowBg:h,labelBgStyle:a,labelBgPadding:u,labelBgBorderRadius:p,style:g,markerEnd:x,markerStart:m,pathOptions:y,interactionWidth:w})=>{const[d,b,M]=Kn({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:c,curvature:y==null?void 0:y.curvature}),E=e.isInternal?void 0:t;return S.jsx(lt,{id:E,path:d,labelX:b,labelY:M,label:l,labelStyle:f,labelShowBg:h,labelBgStyle:a,labelBgPadding:u,labelBgBorderRadius:p,style:g,markerEnd:x,markerStart:m,interactionWidth:w})})}const yc=zo({isInternal:!1}),jo=zo({isInternal:!0});yc.displayName="BezierEdge";jo.displayName="BezierEdgeInternal";const Cn={default:jo,straight:To,step:Ho,smoothstep:_o,simplebezier:ko},Mn={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},xc=(e,t,n)=>n===F.Left?e-t:n===F.Right?e+t:e,wc=(e,t,n)=>n===F.Top?e-t:n===F.Bottom?e+t:e,In="react-flow__edgeupdater";function Pn({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:r,onMouseOut:i,type:c}){return S.jsx("circle",{onMouseDown:s,onMouseEnter:r,onMouseOut:i,className:re([In,`${In}-${c}`]),cx:xc(t,o,e),cy:wc(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function bc({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:s,targetX:r,targetY:i,sourcePosition:c,targetPosition:l,onReconnect:f,onReconnectStart:h,onReconnectEnd:a,setReconnecting:u,setUpdateHover:p}){const g=se(),x=(b,M)=>{if(b.button!==0)return;const{autoPanOnConnect:E,domNode:C,connectionMode:$,connectionRadius:k,lib:j,onConnectStart:v,cancelConnection:N,nodeLookup:_,rfId:T,panBy:H,updateConnection:B}=g.getState(),D=M.type==="target",A=(z,L)=>{u(!1),a==null||a(z,n,M.type,L)},I=z=>f==null?void 0:f(n,z),V=(z,L)=>{u(!0),h==null||h(b,n,M.type),v==null||v(z,L)};Nt.onPointerDown(b.nativeEvent,{autoPanOnConnect:E,connectionMode:$,connectionRadius:k,domNode:C,handleId:M.id,nodeId:M.nodeId,nodeLookup:_,isTarget:D,edgeUpdaterType:M.type,lib:j,flowId:T,cancelConnection:N,panBy:H,isValidConnection:(...z)=>{var L,O;return((O=(L=g.getState()).isValidConnection)==null?void 0:O.call(L,...z))??!0},onConnect:I,onConnectStart:V,onConnectEnd:(...z)=>{var L,O;return(O=(L=g.getState()).onConnectEnd)==null?void 0:O.call(L,...z)},onReconnectEnd:A,updateConnection:B,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle,dragThreshold:g.getState().connectionDragThreshold,handleDomNode:b.currentTarget})},m=b=>x(b,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),y=b=>x(b,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),w=()=>p(!0),d=()=>p(!1);return S.jsxs(S.Fragment,{children:[(e===!0||e==="source")&&S.jsx(Pn,{position:c,centerX:o,centerY:s,radius:t,onMouseDown:m,onMouseEnter:w,onMouseOut:d,type:"source"}),(e===!0||e==="target")&&S.jsx(Pn,{position:l,centerX:r,centerY:i,radius:t,onMouseDown:y,onMouseEnter:w,onMouseOut:d,type:"target"})]})}function Ec({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:s,onDoubleClick:r,onContextMenu:i,onMouseEnter:c,onMouseMove:l,onMouseLeave:f,reconnectRadius:h,onReconnect:a,onReconnectStart:u,onReconnectEnd:p,rfId:g,edgeTypes:x,noPanClassName:m,onError:y,disableKeyboardA11y:w}){let d=J(W=>W.edgeLookup.get(e));const b=J(W=>W.defaultEdgeOptions);d=b?{...b,...d}:d;let M=d.type||"default",E=(x==null?void 0:x[M])||Cn[M];E===void 0&&(y==null||y("011",le.error011(M)),M="default",E=(x==null?void 0:x.default)||Cn.default);const C=!!(d.focusable||t&&typeof d.focusable>"u"),$=typeof a<"u"&&(d.reconnectable||n&&typeof d.reconnectable>"u"),k=!!(d.selectable||o&&typeof d.selectable>"u"),j=P.useRef(null),[v,N]=P.useState(!1),[_,T]=P.useState(!1),H=se(),{zIndex:B,sourceX:D,sourceY:A,targetX:I,targetY:V,sourcePosition:z,targetPosition:L}=J(P.useCallback(W=>{const Y=W.nodeLookup.get(d.source),te=W.nodeLookup.get(d.target);if(!Y||!te)return{zIndex:d.zIndex,...Mn};const ne=xr({id:e,sourceNode:Y,targetNode:te,sourceHandle:d.sourceHandle||null,targetHandle:d.targetHandle||null,connectionMode:W.connectionMode,onError:y});return{zIndex:ur({selected:d.selected,zIndex:d.zIndex,sourceNode:Y,targetNode:te,elevateOnSelect:W.elevateEdgesOnSelect,zIndexMode:W.zIndexMode}),...ne||Mn}},[d.source,d.target,d.sourceHandle,d.targetHandle,d.selected,d.zIndex]),oe),O=P.useMemo(()=>d.markerStart?`url('#${vt(d.markerStart,g)}')`:void 0,[d.markerStart,g]),G=P.useMemo(()=>d.markerEnd?`url('#${vt(d.markerEnd,g)}')`:void 0,[d.markerEnd,g]);if(d.hidden||D===null||A===null||I===null||V===null)return null;const K=W=>{var ee;const{addSelectedEdges:Y,unselectNodesAndEdges:te,multiSelectionActive:ne}=H.getState();k&&(H.setState({nodesSelectionActive:!1}),d.selected&&ne?(te({nodes:[],edges:[d]}),(ee=j.current)==null||ee.blur()):Y([e])),s&&s(W,d)},U=r?W=>{r(W,{...d})}:void 0,q=i?W=>{i(W,{...d})}:void 0,R=c?W=>{c(W,{...d})}:void 0,X=l?W=>{l(W,{...d})}:void 0,Q=f?W=>{f(W,{...d})}:void 0,Z=W=>{var Y;if(!w&&Hn.includes(W.key)&&k){const{unselectNodesAndEdges:te,addSelectedEdges:ne}=H.getState();W.key==="Escape"?((Y=j.current)==null||Y.blur(),te({edges:[d]})):ne([e])}};return S.jsx("svg",{style:{zIndex:B},children:S.jsxs("g",{className:re(["react-flow__edge",`react-flow__edge-${M}`,d.className,m,{selected:d.selected,animated:d.animated,inactive:!k&&!s,updating:v,selectable:k}]),onClick:K,onDoubleClick:U,onContextMenu:q,onMouseEnter:R,onMouseMove:X,onMouseLeave:Q,onKeyDown:C?Z:void 0,tabIndex:C?0:void 0,role:d.ariaRole??(C?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":d.ariaLabel===null?void 0:d.ariaLabel||`Edge from ${d.source} to ${d.target}`,"aria-describedby":C?`${go}-${g}`:void 0,ref:j,...d.domAttributes,children:[!_&&S.jsx(E,{id:e,source:d.source,target:d.target,type:d.type,selected:d.selected,animated:d.animated,selectable:k,deletable:d.deletable??!0,label:d.label,labelStyle:d.labelStyle,labelShowBg:d.labelShowBg,labelBgStyle:d.labelBgStyle,labelBgPadding:d.labelBgPadding,labelBgBorderRadius:d.labelBgBorderRadius,sourceX:D,sourceY:A,targetX:I,targetY:V,sourcePosition:z,targetPosition:L,data:d.data,style:d.style,sourceHandleId:d.sourceHandle,targetHandleId:d.targetHandle,markerStart:O,markerEnd:G,pathOptions:"pathOptions"in d?d.pathOptions:void 0,interactionWidth:d.interactionWidth}),$&&S.jsx(bc,{edge:d,isReconnectable:$,reconnectRadius:h,onReconnect:a,onReconnectStart:u,onReconnectEnd:p,sourceX:D,sourceY:A,targetX:I,targetY:V,sourcePosition:z,targetPosition:L,setUpdateHover:N,setReconnecting:T})]})})}var vc=P.memo(Ec);const Sc=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Bo({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:s,onReconnect:r,onEdgeContextMenu:i,onEdgeMouseEnter:c,onEdgeMouseMove:l,onEdgeMouseLeave:f,onEdgeClick:h,reconnectRadius:a,onEdgeDoubleClick:u,onReconnectStart:p,onReconnectEnd:g,disableKeyboardA11y:x}){const{edgesFocusable:m,edgesReconnectable:y,elementsSelectable:w,onError:d}=J(Sc,oe),b=cc(t);return S.jsxs("div",{className:"react-flow__edges",children:[S.jsx(fc,{defaultColor:e,rfId:n}),b.map(M=>S.jsx(vc,{id:M,edgesFocusable:m,edgesReconnectable:y,elementsSelectable:w,noPanClassName:s,onReconnect:r,onContextMenu:i,onMouseEnter:c,onMouseMove:l,onMouseLeave:f,onClick:h,reconnectRadius:a,onDoubleClick:u,onReconnectStart:p,onReconnectEnd:g,rfId:n,onError:d,edgeTypes:o,disableKeyboardA11y:x},M))]})}Bo.displayName="EdgeRenderer";const Nc=P.memo(Bo),Cc=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Mc({children:e}){const t=J(Cc);return S.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Ic(e){const t=Dt(),n=P.useRef(!1);P.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Pc=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function kc(e){const t=J(Pc),n=se();return P.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function $c(e){return e.connection.inProgress?{...e.connection,to:Ye(e.connection.to,e.transform)}:{...e.connection}}function Ac(e){return $c}function _c(e){const t=Ac();return J(t,oe)}const Lc=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Hc({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:s,width:r,height:i,isValid:c,inProgress:l}=J(Lc,oe);return!(r&&s&&l)?null:S.jsx("svg",{style:e,width:r,height:i,className:"react-flow__connectionline react-flow__container",children:S.jsx("g",{className:re(["react-flow__connection",zn(c)]),children:S.jsx(Vo,{style:t,type:n,CustomComponent:o,isValid:c})})})}const Vo=({style:e,type:t=pe.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:s,from:r,fromNode:i,fromHandle:c,fromPosition:l,to:f,toNode:h,toHandle:a,toPosition:u,pointer:p}=_c();if(!s)return;if(n)return S.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:c,fromX:r.x,fromY:r.y,toX:f.x,toY:f.y,fromPosition:l,toPosition:u,connectionStatus:zn(o),toNode:h,toHandle:a,pointer:p});let g="";const x={sourceX:r.x,sourceY:r.y,sourcePosition:l,targetX:f.x,targetY:f.y,targetPosition:u};switch(t){case pe.Bezier:[g]=Kn(x);break;case pe.SimpleBezier:[g]=Io(x);break;case pe.Step:[g]=Et({...x,borderRadius:0});break;case pe.SmoothStep:[g]=Et(x);break;default:[g]=qn(x)}return S.jsx("path",{d:g,fill:"none",className:"react-flow__connection-path",style:e})};Vo.displayName="ConnectionLine";const Dc={};function kn(e=Dc){P.useRef(e),se(),P.useEffect(()=>{},[e])}function Tc(){se(),P.useRef(!1),P.useEffect(()=>{},[])}function Ro({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:s,onNodeDoubleClick:r,onEdgeDoubleClick:i,onNodeMouseEnter:c,onNodeMouseMove:l,onNodeMouseLeave:f,onNodeContextMenu:h,onSelectionContextMenu:a,onSelectionStart:u,onSelectionEnd:p,connectionLineType:g,connectionLineStyle:x,connectionLineComponent:m,connectionLineContainerStyle:y,selectionKeyCode:w,selectionOnDrag:d,selectionMode:b,multiSelectionKeyCode:M,panActivationKeyCode:E,zoomActivationKeyCode:C,deleteKeyCode:$,onlyRenderVisibleElements:k,elementsSelectable:j,defaultViewport:v,translateExtent:N,minZoom:_,maxZoom:T,preventScrolling:H,defaultMarkerColor:B,zoomOnScroll:D,zoomOnPinch:A,panOnScroll:I,panOnScrollSpeed:V,panOnScrollMode:z,zoomOnDoubleClick:L,panOnDrag:O,onPaneClick:G,onPaneMouseEnter:K,onPaneMouseMove:U,onPaneMouseLeave:q,onPaneScroll:R,onPaneContextMenu:X,paneClickDistance:Q,nodeClickDistance:Z,onEdgeContextMenu:W,onEdgeMouseEnter:Y,onEdgeMouseMove:te,onEdgeMouseLeave:ne,reconnectRadius:ee,onReconnect:ie,onReconnectStart:fe,onReconnectEnd:ue,noDragClassName:ye,noWheelClassName:Ae,noPanClassName:_e,disableKeyboardA11y:Le,nodeExtent:ut,rfId:We,viewport:ve,onViewportChange:He}){return kn(e),kn(t),Tc(),Ic(n),kc(ve),S.jsx(qi,{onPaneClick:G,onPaneMouseEnter:K,onPaneMouseMove:U,onPaneMouseLeave:q,onPaneContextMenu:X,onPaneScroll:R,paneClickDistance:Q,deleteKeyCode:$,selectionKeyCode:w,selectionOnDrag:d,selectionMode:b,onSelectionStart:u,onSelectionEnd:p,multiSelectionKeyCode:M,panActivationKeyCode:E,zoomActivationKeyCode:C,elementsSelectable:j,zoomOnScroll:D,zoomOnPinch:A,zoomOnDoubleClick:L,panOnScroll:I,panOnScrollSpeed:V,panOnScrollMode:z,panOnDrag:O,defaultViewport:v,translateExtent:N,minZoom:_,maxZoom:T,onSelectionContextMenu:a,preventScrolling:H,noDragClassName:ye,noWheelClassName:Ae,noPanClassName:_e,disableKeyboardA11y:Le,onViewportChange:He,isControlledViewport:!!ve,children:S.jsxs(Mc,{children:[S.jsx(Nc,{edgeTypes:t,onEdgeClick:s,onEdgeDoubleClick:i,onReconnect:ie,onReconnectStart:fe,onReconnectEnd:ue,onlyRenderVisibleElements:k,onEdgeContextMenu:W,onEdgeMouseEnter:Y,onEdgeMouseMove:te,onEdgeMouseLeave:ne,reconnectRadius:ee,defaultMarkerColor:B,noPanClassName:_e,disableKeyboardA11y:Le,rfId:We}),S.jsx(Hc,{style:x,type:g,component:m,containerStyle:y}),S.jsx("div",{className:"react-flow__edgelabel-renderer"}),S.jsx(ic,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:r,onNodeMouseEnter:c,onNodeMouseMove:l,onNodeMouseLeave:f,onNodeContextMenu:h,nodeClickDistance:Z,onlyRenderVisibleElements:k,noPanClassName:_e,noDragClassName:ye,disableKeyboardA11y:Le,nodeExtent:ut,rfId:We}),S.jsx("div",{className:"react-flow__viewport-portal"})]})})}Ro.displayName="GraphView";const zc=P.memo(Ro),$n=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,fitViewOptions:c,minZoom:l=.5,maxZoom:f=2,nodeOrigin:h,nodeExtent:a,zIndexMode:u="basic"}={})=>{const p=new Map,g=new Map,x=new Map,m=new Map,y=o??t??[],w=n??e??[],d=h??[0,0],b=a??Te;eo(x,m,y);const M=St(w,p,g,{nodeOrigin:d,nodeExtent:b,zIndexMode:u});let E=[0,0,1];if(i&&s&&r){const C=Fe(p,{filter:v=>!!((v.width||v.initialWidth)&&(v.height||v.initialHeight))}),{x:$,y:k,zoom:j}=Pt(C,s,r,l,f,(c==null?void 0:c.padding)??.1);E=[$,k,j]}return{rfId:"1",width:s??0,height:r??0,transform:E,nodes:w,nodesInitialized:M,nodeLookup:p,parentLookup:g,edges:y,edgeLookup:m,connectionLookup:x,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:l,maxZoom:f,translateExtent:Te,nodeExtent:b,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Me.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:d,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!0,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:c,fitViewResolver:null,connection:{...Tn},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:sr,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Dn,zIndexMode:u,onNodesChangeMiddlewareMap:new Map,onEdgesChangeMiddlewareMap:new Map}},jc=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,fitViewOptions:c,minZoom:l,maxZoom:f,nodeOrigin:h,nodeExtent:a,zIndexMode:u})=>ni((p,g)=>{async function x(){const{nodeLookup:m,panZoom:y,fitViewOptions:w,fitViewResolver:d,width:b,height:M,minZoom:E,maxZoom:C}=g();y&&(await nr({nodes:m,width:b,height:M,panZoom:y,minZoom:E,maxZoom:C},w),d==null||d.resolve(!0),p({fitViewResolver:null}))}return{...$n({nodes:e,edges:t,width:s,height:r,fitView:i,fitViewOptions:c,minZoom:l,maxZoom:f,nodeOrigin:h,nodeExtent:a,defaultNodes:n,defaultEdges:o,zIndexMode:u}),setNodes:m=>{const{nodeLookup:y,parentLookup:w,nodeOrigin:d,elevateNodesOnSelect:b,fitViewQueued:M,zIndexMode:E}=g(),C=St(m,y,w,{nodeOrigin:d,nodeExtent:a,elevateNodesOnSelect:b,checkEquality:!0,zIndexMode:E});M&&C?(x(),p({nodes:m,nodesInitialized:C,fitViewQueued:!1,fitViewOptions:void 0})):p({nodes:m,nodesInitialized:C})},setEdges:m=>{const{connectionLookup:y,edgeLookup:w}=g();eo(y,w,m),p({edges:m})},setDefaultNodesAndEdges:(m,y)=>{if(m){const{setNodes:w}=g();w(m),p({hasDefaultNodes:!0})}if(y){const{setEdges:w}=g();w(y),p({hasDefaultEdges:!0})}},updateNodeInternals:m=>{const{triggerNodeChanges:y,nodeLookup:w,parentLookup:d,domNode:b,nodeOrigin:M,nodeExtent:E,debug:C,fitViewQueued:$,zIndexMode:k}=g(),{changes:j,updatedInternals:v}=Mr(m,w,d,b,M,E,k);v&&(vr(w,d,{nodeOrigin:M,nodeExtent:E,zIndexMode:k}),$?(x(),p({fitViewQueued:!1,fitViewOptions:void 0})):p({}),(j==null?void 0:j.length)>0&&(C&&console.log("React Flow: trigger node changes",j),y==null||y(j)))},updateNodePositions:(m,y=!1)=>{const w=[];let d=[];const{nodeLookup:b,triggerNodeChanges:M,connection:E,updateConnection:C,onNodesChangeMiddlewareMap:$}=g();for(const[k,j]of m){const v=b.get(k),N=!!(v!=null&&v.expandParent&&(v!=null&&v.parentId)&&(j!=null&&j.position)),_={id:k,type:"position",position:N?{x:Math.max(0,j.position.x),y:Math.max(0,j.position.y)}:j.position,dragging:y};if(v&&E.inProgress&&E.fromNode.id===v.id){const T=Ee(v,E.fromHandle,F.Left,!0);C({...E,from:T})}N&&v.parentId&&w.push({id:k,parentId:v.parentId,rect:{...j.internals.positionAbsolute,width:j.measured.width??0,height:j.measured.height??0}}),d.push(_)}if(w.length>0){const{parentLookup:k,nodeOrigin:j}=g(),v=Ht(w,b,k,j);d.push(...v)}for(const k of $.values())d=k(d);M(d)},triggerNodeChanges:m=>{const{onNodesChange:y,setNodes:w,nodes:d,hasDefaultNodes:b,debug:M}=g();if(m!=null&&m.length){if(b){const E=mo(m,d);w(E)}M&&console.log("React Flow: trigger node changes",m),y==null||y(m)}},triggerEdgeChanges:m=>{const{onEdgesChange:y,setEdges:w,edges:d,hasDefaultEdges:b,debug:M}=g();if(m!=null&&m.length){if(b){const E=yo(m,d);w(E)}M&&console.log("React Flow: trigger edge changes",m),y==null||y(m)}},addSelectedNodes:m=>{const{multiSelectionActive:y,edgeLookup:w,nodeLookup:d,triggerNodeChanges:b,triggerEdgeChanges:M}=g();if(y){const E=m.map(C=>xe(C,!0));b(E);return}b(Ce(d,new Set([...m]),!0)),M(Ce(w))},addSelectedEdges:m=>{const{multiSelectionActive:y,edgeLookup:w,nodeLookup:d,triggerNodeChanges:b,triggerEdgeChanges:M}=g();if(y){const E=m.map(C=>xe(C,!0));M(E);return}M(Ce(w,new Set([...m]))),b(Ce(d,new Set,!0))},unselectNodesAndEdges:({nodes:m,edges:y}={})=>{const{edges:w,nodes:d,nodeLookup:b,triggerNodeChanges:M,triggerEdgeChanges:E}=g(),C=m||d,$=y||w,k=[];for(const v of C){if(!v.selected)continue;const N=b.get(v.id);N&&(N.selected=!1),k.push(xe(v.id,!1))}const j=[];for(const v of $)v.selected&&j.push(xe(v.id,!1));M(k),E(j)},setMinZoom:m=>{const{panZoom:y,maxZoom:w}=g();y==null||y.setScaleExtent([m,w]),p({minZoom:m})},setMaxZoom:m=>{const{panZoom:y,minZoom:w}=g();y==null||y.setScaleExtent([w,m]),p({maxZoom:m})},setTranslateExtent:m=>{var y;(y=g().panZoom)==null||y.setTranslateExtent(m),p({translateExtent:m})},resetSelectedElements:()=>{const{edges:m,nodes:y,triggerNodeChanges:w,triggerEdgeChanges:d,elementsSelectable:b}=g();if(!b)return;const M=y.reduce((C,$)=>$.selected?[...C,xe($.id,!1)]:C,[]),E=m.reduce((C,$)=>$.selected?[...C,xe($.id,!1)]:C,[]);w(M),d(E)},setNodeExtent:m=>{const{nodes:y,nodeLookup:w,parentLookup:d,nodeOrigin:b,elevateNodesOnSelect:M,nodeExtent:E,zIndexMode:C}=g();m[0][0]===E[0][0]&&m[0][1]===E[0][1]&&m[1][0]===E[1][0]&&m[1][1]===E[1][1]||(St(y,w,d,{nodeOrigin:b,nodeExtent:m,elevateNodesOnSelect:M,checkEquality:!1,zIndexMode:C}),p({nodeExtent:m}))},panBy:m=>{const{transform:y,width:w,height:d,panZoom:b,translateExtent:M}=g();return Ir({delta:m,panZoom:b,transform:y,translateExtent:M,width:w,height:d})},setCenter:async(m,y,w)=>{const{width:d,height:b,maxZoom:M,panZoom:E}=g();if(!E)return Promise.resolve(!1);const C=typeof(w==null?void 0:w.zoom)<"u"?w.zoom:M;return await E.setViewport({x:d/2-m*C,y:b/2-y*C,zoom:C},{duration:w==null?void 0:w.duration,ease:w==null?void 0:w.ease,interpolate:w==null?void 0:w.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{p({connection:{...Tn}})},updateConnection:m=>{p({connection:m})},reset:()=>p({...$n()})}},Object.is);function Bc({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:s,initialHeight:r,initialMinZoom:i,initialMaxZoom:c,initialFitViewOptions:l,fitView:f,nodeOrigin:h,nodeExtent:a,zIndexMode:u,children:p}){const[g]=P.useState(()=>jc({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:f,minZoom:i,maxZoom:c,fitViewOptions:l,nodeOrigin:h,nodeExtent:a,zIndexMode:u}));return S.jsx(oi,{value:g,children:S.jsx(Mi,{children:p})})}function Vc({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:s,width:r,height:i,fitView:c,fitViewOptions:l,minZoom:f,maxZoom:h,nodeOrigin:a,nodeExtent:u,zIndexMode:p}){return P.useContext(it)?S.jsx(S.Fragment,{children:e}):S.jsx(Bc,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:s,initialWidth:r,initialHeight:i,fitView:c,initialFitViewOptions:l,initialMinZoom:f,initialMaxZoom:h,nodeOrigin:a,nodeExtent:u,zIndexMode:p,children:e})}const Rc={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function Fc({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:r,edgeTypes:i,onNodeClick:c,onEdgeClick:l,onInit:f,onMove:h,onMoveStart:a,onMoveEnd:u,onConnect:p,onConnectStart:g,onConnectEnd:x,onClickConnectStart:m,onClickConnectEnd:y,onNodeMouseEnter:w,onNodeMouseMove:d,onNodeMouseLeave:b,onNodeContextMenu:M,onNodeDoubleClick:E,onNodeDragStart:C,onNodeDrag:$,onNodeDragStop:k,onNodesDelete:j,onEdgesDelete:v,onDelete:N,onSelectionChange:_,onSelectionDragStart:T,onSelectionDrag:H,onSelectionDragStop:B,onSelectionContextMenu:D,onSelectionStart:A,onSelectionEnd:I,onBeforeDelete:V,connectionMode:z,connectionLineType:L=pe.Bezier,connectionLineStyle:O,connectionLineComponent:G,connectionLineContainerStyle:K,deleteKeyCode:U="Backspace",selectionKeyCode:q="Shift",selectionOnDrag:R=!1,selectionMode:X=ze.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:Z=Be()?"Meta":"Control",zoomActivationKeyCode:W=Be()?"Meta":"Control",snapToGrid:Y,snapGrid:te,onlyRenderVisibleElements:ne=!1,selectNodesOnDrag:ee,nodesDraggable:ie,autoPanOnNodeFocus:fe,nodesConnectable:ue,nodesFocusable:ye,nodeOrigin:Ae=ho,edgesFocusable:_e,edgesReconnectable:Le,elementsSelectable:ut=!0,defaultViewport:We=mi,minZoom:ve=.5,maxZoom:He=2,translateExtent:zt=Te,preventScrolling:Wo=!0,nodeExtent:dt,defaultMarkerColor:Xo="#b1b1b7",zoomOnScroll:Go=!0,zoomOnPinch:Zo=!0,panOnScroll:Ko=!1,panOnScrollSpeed:Uo=.5,panOnScrollMode:qo=we.Free,zoomOnDoubleClick:Qo=!0,panOnDrag:Jo=!0,onPaneClick:es,onPaneMouseEnter:ts,onPaneMouseMove:ns,onPaneMouseLeave:os,onPaneScroll:ss,onPaneContextMenu:rs,paneClickDistance:is=1,nodeClickDistance:cs=0,children:as,onReconnect:ls,onReconnectStart:us,onReconnectEnd:ds,onEdgeContextMenu:fs,onEdgeDoubleClick:gs,onEdgeMouseEnter:hs,onEdgeMouseMove:ps,onEdgeMouseLeave:ms,reconnectRadius:ys=10,onNodesChange:xs,onEdgesChange:ws,noDragClassName:bs="nodrag",noWheelClassName:Es="nowheel",noPanClassName:jt="nopan",fitView:Bt,fitViewOptions:Vt,connectOnClick:vs,attributionPosition:Ss,proOptions:Ns,defaultEdgeOptions:Cs,elevateNodesOnSelect:Ms=!0,elevateEdgesOnSelect:Is=!1,disableKeyboardA11y:Rt=!1,autoPanOnConnect:Ps,autoPanOnNodeDrag:ks,autoPanSpeed:$s,connectionRadius:As,isValidConnection:_s,onError:Ls,style:Hs,id:Ft,nodeDragThreshold:Ds,connectionDragThreshold:Ts,viewport:zs,onViewportChange:js,width:Bs,height:Vs,colorMode:Rs="light",debug:Fs,onScroll:Xe,ariaLabelConfig:Os,zIndexMode:Ot="basic",...Ys},Ws){const ft=Ft||"1",Xs=bi(Rs),Gs=P.useCallback(Yt=>{Yt.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Xe==null||Xe(Yt)},[Xe]);return S.jsx("div",{"data-testid":"rf__wrapper",...Ys,onScroll:Gs,style:{...Hs,...Rc},ref:Ws,className:re(["react-flow",s,Xs]),id:Ft,role:"application",children:S.jsxs(Vc,{nodes:e,edges:t,width:Bs,height:Vs,fitView:Bt,fitViewOptions:Vt,minZoom:ve,maxZoom:He,nodeOrigin:Ae,nodeExtent:dt,zIndexMode:Ot,children:[S.jsx(zc,{onInit:f,onNodeClick:c,onEdgeClick:l,onNodeMouseEnter:w,onNodeMouseMove:d,onNodeMouseLeave:b,onNodeContextMenu:M,onNodeDoubleClick:E,nodeTypes:r,edgeTypes:i,connectionLineType:L,connectionLineStyle:O,connectionLineComponent:G,connectionLineContainerStyle:K,selectionKeyCode:q,selectionOnDrag:R,selectionMode:X,deleteKeyCode:U,multiSelectionKeyCode:Z,panActivationKeyCode:Q,zoomActivationKeyCode:W,onlyRenderVisibleElements:ne,defaultViewport:We,translateExtent:zt,minZoom:ve,maxZoom:He,preventScrolling:Wo,zoomOnScroll:Go,zoomOnPinch:Zo,zoomOnDoubleClick:Qo,panOnScroll:Ko,panOnScrollSpeed:Uo,panOnScrollMode:qo,panOnDrag:Jo,onPaneClick:es,onPaneMouseEnter:ts,onPaneMouseMove:ns,onPaneMouseLeave:os,onPaneScroll:ss,onPaneContextMenu:rs,paneClickDistance:is,nodeClickDistance:cs,onSelectionContextMenu:D,onSelectionStart:A,onSelectionEnd:I,onReconnect:ls,onReconnectStart:us,onReconnectEnd:ds,onEdgeContextMenu:fs,onEdgeDoubleClick:gs,onEdgeMouseEnter:hs,onEdgeMouseMove:ps,onEdgeMouseLeave:ms,reconnectRadius:ys,defaultMarkerColor:Xo,noDragClassName:bs,noWheelClassName:Es,noPanClassName:jt,rfId:ft,disableKeyboardA11y:Rt,nodeExtent:dt,viewport:zs,onViewportChange:js}),S.jsx(wi,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:p,onConnectStart:g,onConnectEnd:x,onClickConnectStart:m,onClickConnectEnd:y,nodesDraggable:ie,autoPanOnNodeFocus:fe,nodesConnectable:ue,nodesFocusable:ye,edgesFocusable:_e,edgesReconnectable:Le,elementsSelectable:ut,elevateNodesOnSelect:Ms,elevateEdgesOnSelect:Is,minZoom:ve,maxZoom:He,nodeExtent:dt,onNodesChange:xs,onEdgesChange:ws,snapToGrid:Y,snapGrid:te,connectionMode:z,translateExtent:zt,connectOnClick:vs,defaultEdgeOptions:Cs,fitView:Bt,fitViewOptions:Vt,onNodesDelete:j,onEdgesDelete:v,onDelete:N,onNodeDragStart:C,onNodeDrag:$,onNodeDragStop:k,onSelectionDrag:H,onSelectionDragStart:T,onSelectionDragStop:B,onMove:h,onMoveStart:a,onMoveEnd:u,noPanClassName:jt,nodeOrigin:Ae,rfId:ft,autoPanOnConnect:Ps,autoPanOnNodeDrag:ks,autoPanSpeed:$s,onError:Ls,connectionRadius:As,isValidConnection:_s,selectNodesOnDrag:ee,nodeDragThreshold:Ds,connectionDragThreshold:Ts,onBeforeDelete:V,debug:Fs,ariaLabelConfig:Os,zIndexMode:Ot}),S.jsx(pi,{onSelectionChange:_}),as,S.jsx(ui,{proOptions:Ns,position:Ss}),S.jsx(li,{rfId:ft,disableKeyboardA11y:Rt})]})})}var pa=xo(Fc);function ma(e){const[t,n]=P.useState(e),o=P.useCallback(s=>n(r=>mo(s,r)),[]);return[t,n,o]}function ya(e){const[t,n]=P.useState(e),o=P.useCallback(s=>n(r=>yo(s,r)),[]);return[t,n,o]}function Oc({dimensions:e,lineWidth:t,variant:n,className:o}){return S.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:re(["react-flow__background-pattern",n,o])})}function Yc({radius:e,className:t}){return S.jsx("circle",{cx:e,cy:e,r:e,className:re(["react-flow__background-pattern","dots",t])})}var me;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(me||(me={}));const Wc={[me.Dots]:1,[me.Lines]:1,[me.Cross]:6},Xc=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Fo({id:e,variant:t=me.Dots,gap:n=20,size:o,lineWidth:s=1,offset:r=0,color:i,bgColor:c,style:l,className:f,patternClassName:h}){const a=P.useRef(null),{transform:u,patternId:p}=J(Xc,oe),g=o||Wc[t],x=t===me.Dots,m=t===me.Cross,y=Array.isArray(n)?n:[n,n],w=[y[0]*u[2]||1,y[1]*u[2]||1],d=g*u[2],b=Array.isArray(r)?r:[r,r],M=m?[d,d]:w,E=[b[0]*u[2]||1+M[0]/2,b[1]*u[2]||1+M[1]/2],C=`${p}${e||""}`;return S.jsxs("svg",{className:re(["react-flow__background",f]),style:{...l,...at,"--xy-background-color-props":c,"--xy-background-pattern-color-props":i},ref:a,"data-testid":"rf__background",children:[S.jsx("pattern",{id:C,x:u[0]%w[0],y:u[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`,children:x?S.jsx(Yc,{radius:d/2,className:h}):S.jsx(Oc,{dimensions:M,lineWidth:s,variant:t,className:h})}),S.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${C})`})]})}Fo.displayName="Background";const xa=P.memo(Fo);function Gc(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:S.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Zc(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:S.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Kc(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:S.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Uc(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:S.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function qc(){return S.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:S.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Ue({children:e,className:t,...n}){return S.jsx("button",{type:"button",className:re(["react-flow__controls-button",t]),...n,children:e})}const Qc=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function Oo({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:r,onZoomOut:i,onFitView:c,onInteractiveChange:l,className:f,children:h,position:a="bottom-left",orientation:u="vertical","aria-label":p}){const g=se(),{isInteractive:x,minZoomReached:m,maxZoomReached:y,ariaLabelConfig:w}=J(Qc,oe),{zoomIn:d,zoomOut:b,fitView:M}=Dt(),E=()=>{d(),r==null||r()},C=()=>{b(),i==null||i()},$=()=>{M(s),c==null||c()},k=()=>{g.setState({nodesDraggable:!x,nodesConnectable:!x,elementsSelectable:!x}),l==null||l(!x)},j=u==="horizontal"?"horizontal":"vertical";return S.jsxs(ct,{className:re(["react-flow__controls",j,f]),position:a,style:e,"data-testid":"rf__controls","aria-label":p??w["controls.ariaLabel"],children:[t&&S.jsxs(S.Fragment,{children:[S.jsx(Ue,{onClick:E,className:"react-flow__controls-zoomin",title:w["controls.zoomIn.ariaLabel"],"aria-label":w["controls.zoomIn.ariaLabel"],disabled:y,children:S.jsx(Gc,{})}),S.jsx(Ue,{onClick:C,className:"react-flow__controls-zoomout",title:w["controls.zoomOut.ariaLabel"],"aria-label":w["controls.zoomOut.ariaLabel"],disabled:m,children:S.jsx(Zc,{})})]}),n&&S.jsx(Ue,{className:"react-flow__controls-fitview",onClick:$,title:w["controls.fitView.ariaLabel"],"aria-label":w["controls.fitView.ariaLabel"],children:S.jsx(Kc,{})}),o&&S.jsx(Ue,{className:"react-flow__controls-interactive",onClick:k,title:w["controls.interactive.ariaLabel"],"aria-label":w["controls.interactive.ariaLabel"],children:x?S.jsx(qc,{}):S.jsx(Uc,{})}),h]})}Oo.displayName="Controls";const wa=P.memo(Oo);function Jc({id:e,x:t,y:n,width:o,height:s,style:r,color:i,strokeColor:c,strokeWidth:l,className:f,borderRadius:h,shapeRendering:a,selected:u,onClick:p}){const{background:g,backgroundColor:x}=r||{},m=i||g||x;return S.jsx("rect",{className:re(["react-flow__minimap-node",{selected:u},f]),x:t,y:n,rx:h,ry:h,width:o,height:s,style:{fill:m,stroke:c,strokeWidth:l},shapeRendering:a,onClick:p?y=>p(y,e):void 0})}const ea=P.memo(Jc),ta=e=>e.nodes.map(t=>t.id),wt=e=>e instanceof Function?e:()=>e;function na({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:s,nodeComponent:r=ea,onClick:i}){const c=J(ta,oe),l=wt(t),f=wt(e),h=wt(n),a=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return S.jsx(S.Fragment,{children:c.map(u=>S.jsx(sa,{id:u,nodeColorFunc:l,nodeStrokeColorFunc:f,nodeClassNameFunc:h,nodeBorderRadius:o,nodeStrokeWidth:s,NodeComponent:r,onClick:i,shapeRendering:a},u))})}function oa({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:s,nodeStrokeWidth:r,shapeRendering:i,NodeComponent:c,onClick:l}){const{node:f,x:h,y:a,width:u,height:p}=J(g=>{const x=g.nodeLookup.get(e);if(!x)return{node:void 0,x:0,y:0,width:0,height:0};const m=x.internals.userNode,{x:y,y:w}=x.internals.positionAbsolute,{width:d,height:b}=de(m);return{node:m,x:y,y:w,width:d,height:b}},oe);return!f||f.hidden||!On(f)?null:S.jsx(c,{x:h,y:a,width:u,height:p,style:f.style,selected:!!f.selected,className:o(f),color:t(f),borderRadius:s,strokeColor:n(f),strokeWidth:r,shapeRendering:i,onClick:l,id:f.id})}const sa=P.memo(oa);var ra=P.memo(na);const ia=200,ca=150,aa=e=>!e.hidden,la=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Fn(Fe(e.nodeLookup,{filter:aa}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},ua="react-flow__minimap-desc";function Yo({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:s="",nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:c,bgColor:l,maskColor:f,maskStrokeColor:h,maskStrokeWidth:a,position:u="bottom-right",onClick:p,onNodeClick:g,pannable:x=!1,zoomable:m=!1,ariaLabel:y,inversePan:w,zoomStep:d=1,offsetScale:b=5}){const M=se(),E=P.useRef(null),{boundingRect:C,viewBB:$,rfId:k,panZoom:j,translateExtent:v,flowWidth:N,flowHeight:_,ariaLabelConfig:T}=J(la,oe),H=(e==null?void 0:e.width)??ia,B=(e==null?void 0:e.height)??ca,D=C.width/H,A=C.height/B,I=Math.max(D,A),V=I*H,z=I*B,L=b*I,O=C.x-(V-C.width)/2-L,G=C.y-(z-C.height)/2-L,K=V+L*2,U=z+L*2,q=`${ua}-${k}`,R=P.useRef(0),X=P.useRef();R.current=I,P.useEffect(()=>{if(E.current&&j)return X.current=Tr({domNode:E.current,panZoom:j,getTransform:()=>M.getState().transform,getViewScale:()=>R.current}),()=>{var Y;(Y=X.current)==null||Y.destroy()}},[j]),P.useEffect(()=>{var Y;(Y=X.current)==null||Y.update({translateExtent:v,width:N,height:_,inversePan:w,pannable:x,zoomStep:d,zoomable:m})},[x,m,w,d,v,N,_]);const Q=p?Y=>{var ee;const[te,ne]=((ee=X.current)==null?void 0:ee.pointer(Y))||[0,0];p(Y,{x:te,y:ne})}:void 0,Z=g?P.useCallback((Y,te)=>{const ne=M.getState().nodeLookup.get(te).internals.userNode;g(Y,ne)},[]):void 0,W=y??T["minimap.ariaLabel"];return S.jsx(ct,{position:u,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof f=="string"?f:void 0,"--xy-minimap-mask-stroke-color-props":typeof h=="string"?h:void 0,"--xy-minimap-mask-stroke-width-props":typeof a=="number"?a*I:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:re(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:S.jsxs("svg",{width:H,height:B,viewBox:`${O} ${G} ${K} ${U}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":q,ref:E,onClick:Q,children:[W&&S.jsx("title",{id:q,children:W}),S.jsx(ra,{onClick:Z,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:r,nodeClassName:s,nodeStrokeWidth:i,nodeComponent:c}),S.jsx("path",{className:"react-flow__minimap-mask",d:`M${O-L},${G-L}h${K+L*2}v${U+L*2}h${-K-L*2}z
        M${$.x},${$.y}h${$.width}v${$.height}h${-$.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Yo.displayName="MiniMap";P.memo(Yo);const da=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,fa={[$e.Line]:"right",[$e.Handle]:"bottom-right"};function ga({nodeId:e,position:t,variant:n=$e.Handle,className:o,style:s=void 0,children:r,color:i,minWidth:c=10,minHeight:l=10,maxWidth:f=Number.MAX_VALUE,maxHeight:h=Number.MAX_VALUE,keepAspectRatio:a=!1,resizeDirection:u,autoScale:p=!0,shouldResize:g,onResizeStart:x,onResize:m,onResizeEnd:y}){const w=vo(),d=typeof e=="string"?e:w,b=se(),M=P.useRef(null),E=n===$e.Handle,C=J(P.useCallback(da(E&&p),[E,p]),oe),$=P.useRef(null),k=t??fa[n];P.useEffect(()=>{if(!(!M.current||!d))return $.current||($.current=Ur({domNode:M.current,nodeId:d,getStoreItems:()=>{const{nodeLookup:v,transform:N,snapGrid:_,snapToGrid:T,nodeOrigin:H,domNode:B}=b.getState();return{nodeLookup:v,transform:N,snapGrid:_,snapToGrid:T,nodeOrigin:H,paneDomNode:B}},onChange:(v,N)=>{const{triggerNodeChanges:_,nodeLookup:T,parentLookup:H,nodeOrigin:B}=b.getState(),D=[],A={x:v.x,y:v.y},I=T.get(d);if(I&&I.expandParent&&I.parentId){const V=I.origin??B,z=v.width??I.measured.width??0,L=v.height??I.measured.height??0,O={id:I.id,parentId:I.parentId,rect:{width:z,height:L,...Yn({x:v.x??I.position.x,y:v.y??I.position.y},{width:z,height:L},I.parentId,T,V)}},G=Ht([O],T,H,B);D.push(...G),A.x=v.x?Math.max(V[0]*z,v.x):void 0,A.y=v.y?Math.max(V[1]*L,v.y):void 0}if(A.x!==void 0&&A.y!==void 0){const V={id:d,type:"position",position:{...A}};D.push(V)}if(v.width!==void 0&&v.height!==void 0){const z={id:d,type:"dimensions",resizing:!0,setAttributes:u?u==="horizontal"?"width":"height":!0,dimensions:{width:v.width,height:v.height}};D.push(z)}for(const V of N){const z={...V,type:"position"};D.push(z)}_(D)},onEnd:({width:v,height:N})=>{const _={id:d,type:"dimensions",resizing:!1,dimensions:{width:v,height:N}};b.getState().triggerNodeChanges([_])}})),$.current.update({controlPosition:k,boundaries:{minWidth:c,minHeight:l,maxWidth:f,maxHeight:h},keepAspectRatio:a,resizeDirection:u,onResizeStart:x,onResize:m,onResizeEnd:y,shouldResize:g}),()=>{var v;(v=$.current)==null||v.destroy()}},[k,c,l,f,h,a,x,m,y,g]);const j=k.split("-");return S.jsx("div",{className:re(["react-flow__resize-control","nodrag",...j,n,o]),ref:M,style:{...s,scale:C,...i&&{[E?"backgroundColor":"borderColor"]:i}},children:r})}P.memo(ga);export{xa as B,wa as C,ya as a,hr as b,pa as i,ma as u};
